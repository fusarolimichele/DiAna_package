<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DiAna">
<title>Causal inference • DiAna</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Causal inference">
<meta property="og:description" content="DiAna">
<meta property="og:image" content="https://fusarolimichele.github.io/DiAna_package/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DiAna</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Get started</h6>
    <a class="dropdown-item" href="../articles/Start_Subproject.html">Start_Subproject</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Disproportionality Analysis</h6>
    <a class="dropdown-item" href="../articles/Disproportionality_Analysis.html">Disproportionality_Analysis</a>
    <a class="dropdown-item" href="../articles/Causal_inference.html">Causal inference</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fusarolimichele/DiAna_package/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Causal inference</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fusarolimichele/DiAna_package/blob/HEAD/vignettes/articles/Causal_inference.Rmd" class="external-link"><code>vignettes/articles/Causal_inference.Rmd</code></a></small>
      <div class="d-none name"><code>Causal_inference.Rmd</code></div>
    </div>

    
    
<p>This tutorial demonstrates how to apply causal inference reasoning to
disproportionality analyses (DPAs), using a step-by-step example from
the preprint article available at <a href="https://osf.io/preprints/osf/h5w9u" class="external-link">this link</a>. In
pharmacovigilance, there are two common but opposing tendencies: either
avoiding any consideration of causality altogether, which renders the
analysis cautious but ineffective, or mistakenly equating association
with causation, leading to incorrect conclusions. However, tools exist
for performing causal inference even on observational and imperfect
data, after specifying certain assumptions. In this tutorial, we
demonstrate the practical benefits of using Directed Acyclic Graphs
(DAGs) to guide conditioning in disproportionality analysis of
Individual Case Safety Reports (ICSRs). This approach can serve as a
valuable link to more comprehensive pharmacovigilance and
pharmacoepidemiological studies.</p>
<p>For an extensive discussion about applying causal inference to
disproportionality analysis, check the <a href="https://osf.io/preprints/osf/h5w9u" class="external-link">preprint</a>.</p>
<div class="section level2">
<h2 id="requisites">Requisites<a class="anchor" aria-label="anchor" href="#requisites"></a>
</h2>
<p>This tutorial requires that you have first:</p>
<ol style="list-style-type: decimal">
<li><p>installed R and R Studio,</p></li>
<li><p>installed the DiAna package,</p></li>
<li><p>and set up your project folder.</p></li>
</ol>
<p>Otherwise get back to the ReadMe and follow the instructions.</p>
<p>It is also recommended that you have read the previous vignettes. In
particular, the <a href="Disproportionality_Analysis.html">disproportionality analysis
tutorial</a> is extremely recommended.</p>
</div>
<div class="section level2">
<h2 id="start-the-subproject">Start the subproject<a class="anchor" aria-label="anchor" href="#start-the-subproject"></a>
</h2>
<p>From the DiAna main project, we open a new R script and run the
snippet ‘new_FAERS_project’ to set up a project, and then tailor the
information thus precompiled (note that we are here running the analysis
including also quarter up to 24Q1, while the preprint was limited to
23Q1).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information -----------------------------------------------------------------</span></span>
<span><span class="co">## Project title --------------------------------------------------------------</span></span>
<span><span class="co">### "Causal inference tools for pharmacovigilance"</span></span>
<span><span class="co">## Data -----------------------------------------------------------------------</span></span>
<span><span class="co">### FDA Adverse Event Reporting System Quarterly Data</span></span>
<span></span>
<span><span class="co">## Authors of the preprint ----------------------------------------------------</span></span>
<span><span class="co">### - Michele Fusaroli</span></span>
<span><span class="co">### - Joseph Mitchell</span></span>
<span><span class="co">### - Annette Rudolph</span></span>
<span><span class="co">### - Elena Rocca</span></span>
<span><span class="co">### - Riccardo Fusaroli</span></span>
<span></span>
<span><span class="co">## Version --------------------------------------------------------------------</span></span>
<span><span class="co">### Set up: 2024-07-29</span></span>
<span><span class="co">### Last update: 2024-07-29</span></span>
<span><span class="co">### DiAna version: 2.1.0</span></span>
<span></span>
<span><span class="co"># Set up ----------------------------------------------------------------------</span></span>
<span><span class="co">## upload DiAna ---------------------------------------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fusarolimichele/DiAna_package" class="external-link">DiAna</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Project_path ---------------------------------------------------------------</span></span>
<span><span class="va">DiAna_path</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">project_name</span> <span class="op">&lt;-</span> <span class="st">"Causal inference"</span></span>
<span><span class="va">project_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DiAna_path</span>, <span class="st">"/projects/"</span>, <span class="va">project_name</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">project_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">project_path</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">project_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">project_path</span>, <span class="st">"/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## FAERS_version --------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">FAERS_version</span> <span class="op">&lt;-</span> <span class="st">"24Q1"</span></span>
<span></span>
<span><span class="co">## Import data ----------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"DRUG"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid   drug_seq       substance role_cod</span></span>
<span><span class="co">#&gt;               &lt;num&gt;      &lt;int&gt;          &lt;fctr&gt;    &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4261825 1004486228        atropine        C</span></span>
<span><span class="co">#&gt;        2:   4261825 1004486228   diphenoxylate        C</span></span>
<span><span class="co">#&gt;        3:   4262057 1004487206     amoxicillin       PS</span></span>
<span><span class="co">#&gt;        4:   4262057 1004487206 clavulanic acid       PS</span></span>
<span><span class="co">#&gt;        5:   4262057 1004487210        macrogol        C</span></span>
<span><span class="co">#&gt;       ---                                              </span></span>
<span><span class="co">#&gt; 69763501: 992001227        580      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763502: 992001227        581      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763503: 992001227        582      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763504: 992001227        586       magnesium        C</span></span>
<span><span class="co">#&gt; 69763505: 992001227        587       magnesium        C</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"REAC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid                            pt drug_rec_act</span></span>
<span><span class="co">#&gt;               &lt;num&gt;                         &lt;ord&gt;        &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4204616                abdominal pain         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        2:   4204616          heart rate increased         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        3:   4204616                        nausea         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        4:   4204616                       pyrexia         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        5:   4204616            uterine tenderness         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;       ---                                                     </span></span>
<span><span class="co">#&gt; 52222720: 237079291         chemical burn of skin         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222721: 237079291    toxicity to various agents         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222722: 237079291                          scar         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222723: 237203351 injection site discolouration         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222724: 237203351       injection site bruising         &lt;NA&gt;</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"DEMO"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid    sex age_in_days wt_in_kgs occr_country event_dt occp_cod          reporter_country rept_cod</span></span>
<span><span class="co">#&gt;               &lt;num&gt; &lt;fctr&gt;       &lt;num&gt;     &lt;num&gt;       &lt;fctr&gt;    &lt;int&gt;   &lt;fctr&gt;                    &lt;fctr&gt;   &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;        1:  45217461      M        9855        NA         &lt;NA&gt; 19861106       MD  United States of America      DIR</span></span>
<span><span class="co">#&gt;        2:  57910401   &lt;NA&gt;          NA        NA         &lt;NA&gt;       NA     &lt;NA&gt;  United States of America      DIR</span></span>
<span><span class="co">#&gt;        3:  56962401   &lt;NA&gt;          NA        NA         &lt;NA&gt; 19960123     &lt;NA&gt;  United States of America      DIR</span></span>
<span><span class="co">#&gt;        4:  54662121      F       22630        NA         &lt;NA&gt; 19960919       CN South Africa, Republic of      EXP</span></span>
<span><span class="co">#&gt;        5:  31231172      F       21535        68         &lt;NA&gt; 19970927       MD  United States of America      EXP</span></span>
<span><span class="co">#&gt;       ---                                                                                                         </span></span>
<span><span class="co">#&gt; 17598475: 236937711      F        9490        68         &lt;NA&gt; 20240318       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598476: 236937721      M        6205        NA         &lt;NA&gt; 20240101       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598477: 236937741      F       13140       134         &lt;NA&gt; 20240322       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598478: 237079261      F       15695        90         &lt;NA&gt;       NA       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598479: 237079291      M       22265       108         &lt;NA&gt; 20240228       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt;           init_fda_dt   fda_dt premarketing literature RB_duplicates RB_duplicates_only_susp</span></span>
<span><span class="co">#&gt;                 &lt;int&gt;    &lt;int&gt;       &lt;lgcl&gt;     &lt;lgcl&gt;        &lt;lgcl&gt;                  &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt;        1:    19861224 19861224        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        2:    19920917 19920917        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        3:    19960126 19960126        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        4:    19961022 19961022        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        5:    19971203 19971212        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;       ---                                                                                   </span></span>
<span><span class="co">#&gt; 17598475:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598476:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598477:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598478:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598479:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"INDI"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid   drug_seq                                 indi_pt</span></span>
<span><span class="co">#&gt;               &lt;num&gt;      &lt;int&gt;                                   &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4204616 1004278786                        abortion induced</span></span>
<span><span class="co">#&gt;        2:   4223542 1004334703                         crohn's disease</span></span>
<span><span class="co">#&gt;        3:   4250482 1004434717                         crohn's disease</span></span>
<span><span class="co">#&gt;        4:   4261823 1004486217                     bronchial carcinoma</span></span>
<span><span class="co">#&gt;        5:   4261823 1004486218                     bronchial carcinoma</span></span>
<span><span class="co">#&gt;       ---                                                             </span></span>
<span><span class="co">#&gt; 41380269: 992001227        583     product used for unknown indication</span></span>
<span><span class="co">#&gt; 41380270: 992001227        586     product used for unknown indication</span></span>
<span><span class="co">#&gt; 41380271: 236936391          1 beta haemolytic streptococcal infection</span></span>
<span><span class="co">#&gt; 41380272: 237079291          1                    acrochordon excision</span></span>
<span><span class="co">#&gt; 41380273: 237203351          1     product used for unknown indication</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"OUTC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid outc_cod</span></span>
<span><span class="co">#&gt;               &lt;num&gt;    &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4204616       HO</span></span>
<span><span class="co">#&gt;        2:   4204616       RI</span></span>
<span><span class="co">#&gt;        3:   4214534       DE</span></span>
<span><span class="co">#&gt;        4:   4223542       OT</span></span>
<span><span class="co">#&gt;        5:   4250482       OT</span></span>
<span><span class="co">#&gt;       ---                   </span></span>
<span><span class="co">#&gt; 12914603: 986902733       OT</span></span>
<span><span class="co">#&gt; 12914604: 987122169       HO</span></span>
<span><span class="co">#&gt; 12914605: 987122169       OT</span></span>
<span><span class="co">#&gt; 12914606: 992001227       HO</span></span>
<span><span class="co">#&gt; 12914607: 992001227       OT</span></span>
<span><span class="fu"><a href="../reference/import_ATC.html">import_ATC</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                      substance    code primary_code   Lvl4</span></span>
<span><span class="co">#&gt;                                         &lt;char&gt;  &lt;char&gt;       &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1:   lutetium (177lu) vipivotide tetraxetan V10XX05      V10XX05  V10XX</span></span>
<span><span class="co">#&gt;    2:                lutetium (177lu) dotatate V10XX04      V10XX04  V10XX</span></span>
<span><span class="co">#&gt;    3:                    radium-223 dichloride V10XX03      V10XX03  V10XX</span></span>
<span><span class="co">#&gt;    4:                     ibritumomab tiuxetan V10XX02      V10XX02  V10XX</span></span>
<span><span class="co">#&gt;    5:                        lutetium (lu 177)   V10XX        V10XX  V10XX</span></span>
<span><span class="co">#&gt;   ---                                                                     </span></span>
<span><span class="co">#&gt; 3205:                         sodium perborate A01AB19      A01AB19  A01AB</span></span>
<span><span class="co">#&gt; 3206:                                 domiphen A01AB06      A01AB06  A01AB</span></span>
<span><span class="co">#&gt; 3207:               sodium monofluorophosphate A01AA02      A01AA02  A01AA</span></span>
<span><span class="co">#&gt; 3208:                          sodium fluoride A01AA01      A01AA01  A01AA</span></span>
<span><span class="co">#&gt; 3209: stomatological preparations, unspecified    A01A         A01A   A01A</span></span>
<span><span class="co">#&gt;                                                        Class4   Lvl3                               Class3   Lvl2</span></span>
<span><span class="co">#&gt;                                                        &lt;char&gt; &lt;char&gt;                               &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1:                Various therapeutic radiopharmaceuticals   V10X Other diagnostic radiopharmaceutical    V10</span></span>
<span><span class="co">#&gt;    2:                Various therapeutic radiopharmaceuticals   V10X Other diagnostic radiopharmaceutical    V10</span></span>
<span><span class="co">#&gt;    3:                Various therapeutic radiopharmaceuticals   V10X Other diagnostic radiopharmaceutical    V10</span></span>
<span><span class="co">#&gt;    4:                Various therapeutic radiopharmaceuticals   V10X Other diagnostic radiopharmaceutical    V10</span></span>
<span><span class="co">#&gt;    5:                Various therapeutic radiopharmaceuticals   V10X Other diagnostic radiopharmaceutical    V10</span></span>
<span><span class="co">#&gt;   ---                                                                                                           </span></span>
<span><span class="co">#&gt; 3205: Antiinfectives and antiseptics for local oral treatment   A01A          Stomatological preparations    A01</span></span>
<span><span class="co">#&gt; 3206: Antiinfectives and antiseptics for local oral treatment   A01A          Stomatological preparations    A01</span></span>
<span><span class="co">#&gt; 3207:                              Caries prophylactic agents   A01A          Stomatological preparations    A01</span></span>
<span><span class="co">#&gt; 3208:                              Caries prophylactic agents   A01A          Stomatological preparations    A01</span></span>
<span><span class="co">#&gt; 3209:                                                    &lt;NA&gt;   A01A          Stomatological preparations    A01</span></span>
<span><span class="co">#&gt;                                 Class2   Lvl1                    Class1</span></span>
<span><span class="co">#&gt;                                 &lt;char&gt; &lt;char&gt;                    &lt;char&gt;</span></span>
<span><span class="co">#&gt;    1: Therapeutic radiopharmaceuticals      V                   Various</span></span>
<span><span class="co">#&gt;    2: Therapeutic radiopharmaceuticals      V                   Various</span></span>
<span><span class="co">#&gt;    3: Therapeutic radiopharmaceuticals      V                   Various</span></span>
<span><span class="co">#&gt;    4: Therapeutic radiopharmaceuticals      V                   Various</span></span>
<span><span class="co">#&gt;    5: Therapeutic radiopharmaceuticals      V                   Various</span></span>
<span><span class="co">#&gt;   ---                                                                  </span></span>
<span><span class="co">#&gt; 3205:      Stomatological preparations      A Alimentary and Metabolism</span></span>
<span><span class="co">#&gt; 3206:      Stomatological preparations      A Alimentary and Metabolism</span></span>
<span><span class="co">#&gt; 3207:      Stomatological preparations      A Alimentary and Metabolism</span></span>
<span><span class="co">#&gt; 3208:      Stomatological preparations      A Alimentary and Metabolism</span></span>
<span><span class="co">#&gt; 3209:      Stomatological preparations      A Alimentary and Metabolism</span></span>
<span><span class="fu"><a href="../reference/import_MedDRA.html">import_MedDRA</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           def                                            soc                                                  hlgt</span></span>
<span><span class="co">#&gt;        &lt;char&gt;                                         &lt;char&gt;                                                &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1:   cong     congenital, familial and genetic disorders        metabolic and nutritional disorders congenital</span></span>
<span><span class="co">#&gt;     2:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     3:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     4:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     5:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;    ---                                                                                                            </span></span>
<span><span class="co">#&gt; 25408:  inj&amp;p injury, poisoning and procedural complications     procedural related injuries and complications nec</span></span>
<span><span class="co">#&gt; 25409:   preg pregnancy, puerperium and perinatal conditions pregnancy, labour, delivery and postpartum conditions</span></span>
<span><span class="co">#&gt; 25410:   surg                surgical and medical procedures   obstetric and gynaecological therapeutic procedures</span></span>
<span><span class="co">#&gt; 25411:   surg                surgical and medical procedures             male genital tract therapeutic procedures</span></span>
<span><span class="co">#&gt; 25412:  blood           blood and lymphatic system disorders                            white blood cell disorders</span></span>
<span><span class="co">#&gt;                                                  hlt                               pt</span></span>
<span><span class="co">#&gt;                                               &lt;char&gt;                           &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1:            inborn errors of steroid synthesis   11-beta-hydroxylase deficiency</span></span>
<span><span class="co">#&gt;     2:                 reproductive hormone analyses            17 ketosteroids urine</span></span>
<span><span class="co">#&gt;     3:                 reproductive hormone analyses  17 ketosteroids urine decreased</span></span>
<span><span class="co">#&gt;     4:                 reproductive hormone analyses  17 ketosteroids urine increased</span></span>
<span><span class="co">#&gt;     5:                 reproductive hormone analyses     17 ketosteroids urine normal</span></span>
<span><span class="co">#&gt;    ---                                                                               </span></span>
<span><span class="co">#&gt; 25408:    non-site specific procedural complications     incision site skin puckering</span></span>
<span><span class="co">#&gt; 25409:         normal pregnancy, labour and delivery spontaneous rupture of membranes</span></span>
<span><span class="co">#&gt; 25410:                 cervix therapeutic procedures           cervix stent placement</span></span>
<span><span class="co">#&gt; 25411: male genital tract therapeutic procedures nec           sperm cryopreservation</span></span>
<span><span class="co">#&gt; 25412:                        eosinophilic disorders      paraneoplastic eosinophilia</span></span>
<span></span>
<span><span class="co">## Tutorial -------------------------------------------------------------------</span></span></code></pre></div>
<div class="section level3">
<h3 id="statistical-and-causal-dependence">Statistical and causal dependence<a class="anchor" aria-label="anchor" href="#statistical-and-causal-dependence"></a>
</h3>
<div class="float">
<img src="causal_inference-causal_estimand.png" alt="Formalized inquiry"><div class="figcaption">Formalized inquiry</div>
</div>
<p>Our inquiry (grey arrow with a question mark) concerns the existence
of a direct causal relationship between drug and event. Assuming, for
the sake of the example, a simplified scenario with no other factor
involved, a sample size sufficient to reliably exclude chance
association, and no reporting bias, there are only two possible
scenarios: statistical independence suggesting causal independence or
statistical dependence suggesting causal dependence. Disproportionality
analysis helps discriminate between these two scenarios.</p>
<div class="section level4">
<h4 id="statistical-independence">Statistical independence<a class="anchor" aria-label="anchor" href="#statistical-independence"></a>
</h4>
<div class="float">
<img src="causal_inference-independence.png" alt="Causal independence. Paracetamol and breast cancer are expected to be independent."><div class="figcaption">Causal independence. Paracetamol and breast
cancer are expected to be independent.</div>
</div>
<p>Based on what we know, we expect that paracetamol has no causal
dependence with breast cancer. For this reason we expect to find no
association (statistical dependence) between the two.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Tutorial -------------------------------------------------------------------</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="st">"paracetamol"</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="st">"breast cancer"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IC = "</span>,<span class="va">disproportionality_df</span><span class="op">$</span><span class="va">label_IC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "IC = -1.63 (-1.72--1.57) [1511]"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="causal_inference-Forest_Par_BrK-1.png" alt="IC (Paracetamol , BreastCancer)"><div class="figcaption">IC (Paracetamol , BreastCancer)</div>
</div>
<p>Note that the negative association that we find should not be
interpreted as the existence of a protective effect of paracetamol
against breast cancer. First, DPA has amongst its goals to identify
early warnings of ADRs, and not unexpected positive effects. Second, DPA
relies on reports that are likely not representative of patients with
the same susceptibility to the event but not being administered the
drug. We could for example imagine that patients with breast cancer are
less likely to record paracetamol in favour of anticancer drugs relative
to patients with other diseases. Whether a causal inference informed
pharmacovigilance could make better use of negative associations is
outside the scope of this tutorial.</p>
</div>
<div class="section level4">
<h4 id="statistical-dependence">Statistical dependence<a class="anchor" aria-label="anchor" href="#statistical-dependence"></a>
</h4>
<div class="section level5">
<h5 id="direct-causality">Direct causality<a class="anchor" aria-label="anchor" href="#direct-causality"></a>
</h5>
<div class="float">
<img src="causal_inference-direct.png" alt="Direct causality. Pramipexole-induced impulsivity."><div class="figcaption">Direct causality. Pramipexole-induced
impulsivity.</div>
</div>
<p>A well known example of direct causality (an actual adverse drug
reaction) is pramipexole-induced impulse-control disorder. Here below we
find a strong association between the reporting of pramipexole and the
reporting of impulse-control disorders.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="st">"pramipexole"</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="st">"impulse-control disorder"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IC = "</span>,<span class="va">disproportionality_df</span><span class="op">$</span><span class="va">label_IC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "IC = 6.78 (6.61-6.89) [418]"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="causal_inference-Forest_Pram_ICD-1.png" alt="IC (Pramipexole , ImpulseControlDisorder)"><div class="figcaption">IC (Pramipexole , ImpulseControlDisorder)</div>
</div>
</div>
<div class="section level5">
<h5 id="reverse-causality">Reverse causality<a class="anchor" aria-label="anchor" href="#reverse-causality"></a>
</h5>
<div class="float">
<img src="causal_inference-reverse.png" alt="Reverse causality. Edaravone does not causes amyotrophic lateral sclerosis. Rather, being diagnosed with amyotrophic lateral sclerosis results in the prescription of edaravone."><div class="figcaption">Reverse causality. Edaravone does not causes
amyotrophic lateral sclerosis. Rather, being diagnosed with amyotrophic
lateral sclerosis results in the prescription of edaravone.</div>
</div>
<p>The occurrence of an event may justify the administration of a drug,
as in the case where the event is the indication for using the drug. For
example, edaravone is used to treat amyotrophic lateral sclerosis, and
we will expect to find an association between the two (DPA cannot
discriminate between direct and reverse causality). In these cases,
clinical reasoning is crucial to correctly assess the association.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="st">"edaravone"</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="st">"amyotrophic lateral sclerosis"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"IC = "</span>,<span class="va">disproportionality_df</span><span class="op">$</span><span class="va">label_IC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "IC = 7.7 (7.46-7.88) [189]"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error in knitr::include_graphics("causal_inference-Forest_EDA_AL\n S-1.png", : Cannot find the file(s): "causal_inference-Forest_EDA_AL</span></span>
<span><span class="co">#&gt;  S-1.png"</span></span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="confounding-bias">Confounding bias<a class="anchor" aria-label="anchor" href="#confounding-bias"></a>
</h3>
<p>Many pharmacovigilance biases can be reframed as confounding biases,
that is, open backdoor paths through which information flows even in
absence of causal dependencies, thus potentially resulting in a spurious
association. In all these cases the solution is the same: closing the
backdoor, that is conditioning directly on this element - the confounder
C -, or on any of the other nodes on the backdoor path.</p>
<div class="section level4">
<h4 id="confounding-by-indication">Confounding by indication<a class="anchor" aria-label="anchor" href="#confounding-by-indication"></a>
</h4>
<div class="float">
<img src="causal_inference-confounding_indi.png" alt="Confounding by indication. The exposure (haloperidol) and outcome (impulsivity) are caused by the same factor (schizophrenia), potentially resulting in a spurious association."><div class="figcaption">Confounding by indication. The exposure
(haloperidol) and outcome (impulsivity) are caused by the same factor
(schizophrenia), potentially resulting in a spurious association.</div>
</div>
<p>Let us consider a case of indication bias (an event associated with a
drug is in fact caused by the drug indication). If we investigate the
relation between haloperidol and gambling, we do indeed find a positive
statistical association in the data (grey estimate). However, we need to
consider that schizophrenia is likely a common cause of both:
schizophrenia is both an approved indication for haloperidol, and often
associated with impulsivity. Since patients prescribed haloperidol are
likely to have schizophrenia, and patients with schizophrenia tend to be
more impulsive, we might observe an association between haloperidol and
impulsivity even without any causal effect of D on E. We should thus
condition on schizophrenia, for instance by restricting our analysis to
only reports recording schizophrenia among indications. As we do so, the
association between haloperidol and impulsivity disappears (gold
estimate), suggesting a lack of causation. Note, however, that
restricting the analysis to reports that do not mention schizophrenia
would not be as effective at closing the backdoor: many of these reports
might still pertain to patients with schizophrenia without specifying
that, and indeed in those reports we observe the same positive
association (blue estimate) that we also observe without conditioning.
In this scenario, appropriately conditioning on the confounder allowed
us to discard a spurious signal of disproportionate reporting during
signal refinement.</p>
<p>The negative association we get could suggest a protective effect of
haloperidol against impulsivity. That seems indeed to be the case: by
treating (some aspects of) schizophrenia, which also causes impulsivity,
haloperidol can reduce impulsivity. However, in pharmacovigilance
negative associations are typically not considered. This caution is
again driven by the specific features of disproportionality analysis.
First, DPA has amongst its goals to identify early warnings of ADRs, and
not unexpected positive effects. Second, DPA relies on reports that are
likely not representative of patients with the same susceptibility to
the event but not being administered the drug. Whether a causal
inference informed pharmacovigilance could make better use of negative
associations is outside the scope of this tutorial.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pids_schizophrenia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Indi</span><span class="op">[</span><span class="va">indi_pt</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">MedDRA</span><span class="op">[</span><span class="va">hlgt</span><span class="op">==</span><span class="st">"schizophrenia and other psychotic disorders"</span><span class="op">]</span><span class="op">$</span><span class="va">pt</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">restrictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"main"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span><span class="op">)</span>,<span class="st">"schizophrenia"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pids_schizophrenia</span><span class="op">)</span><span class="op">)</span><span class="co">#,"not_schizophrenia"=list(setdiff(unique(Demo$primaryid),pids_schizophrenia)))</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">restrictions</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">restrictions</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span>  <span class="va">t_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">t_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span>drug_selected<span class="op">=</span><span class="st">"haloperidol"</span>,</span>
<span>                                    reac_selected <span class="op">=</span> <span class="st">"gambling disorder"</span>,</span>
<span>                                    meddra_level <span class="op">=</span> <span class="st">"pt"</span>,</span>
<span>                                    restriction <span class="op">=</span> <span class="va">t_pids</span><span class="op">)</span><span class="op">[</span>,<span class="va">nested</span><span class="op">:=</span><span class="va">t_name</span><span class="op">]</span></span>
<span>  <span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">disproportionality_df</span>,<span class="va">df</span><span class="op">)</span>,fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="va">disproportionality_df</span><span class="op">[</span>,<span class="va">nested</span><span class="op">:=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nested</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_schizophrenia"</span>,<span class="st">"main"</span>,<span class="st">"schizophrenia"</span><span class="op">)</span>,ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">disproportionality_df</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">nested</span>,<span class="va">label_IC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;           nested                label_IC</span></span>
<span><span class="co">#&gt;            &lt;ord&gt;                  &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:          main   2.19 (1.69-2.54) [45]</span></span>
<span><span class="co">#&gt; 2: schizophrenia -0.91 (-1.64--0.4) [21]</span></span></code></pre></div>
<p>``{r Forest_halo_gamb, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_halo_gamb-1.png”, :
Cannot find the file(s): “causal_inference-Forest_halo_gamb-1.png”</p>
<pre><code>

#### Confounding by comorbidity

![Confounding by comorbidity. The indication (schizophrenia) for using the drug (quetiapine) is frequently comorbid with another disease (alcohol use disorder) which causes the outcome (osteoporosis), potentially resulting in a spurious association.](causal_inference-confounding_comorb.png)

Another instance involves the issue of confounding by comorbidity (a comorbidity of the indication for using the drug is the real cause of the event). Here, our focus might be on investigating whether quetiapine leads to osteoporosis. However, since quetiapine is often prescribed for schizophrenia, which frequently co-occurs with alcoholism—a known risk factor for osteoporosis—we encounter a positive confounding effect. This means we could find a statistical dependence (grey estimate) even in the absence of a causal dependence. When we condition on reports of alcoholism, the association tends to vanish (gold estimate), although we cannot determine whether this is simply due to increased uncertainty, since only a small number of reports mentions alcoholism-related terms. Alternatively, we could restrict to schizophrenia reports, which would mitigate the positive confounding effect. Note, however, this restriction would also address a negative confounding factor not depicted in the Directed Acyclic Graph (DAG): the association between schizophrenia and younger age, which correlates with a reduced risk of osteoporosis. For this reason it is always important to remember that DAG help causal inference, but that these inferences are true as long as the assumptions drawn in the DAG are verified (and may be distorted by an incomplete or wrong DAG). Thus, the impact of conditioning is less straightforward to predict. Another possibility would be to restrict to all reports without mentions of alcoholism (blue estimate), however, alcoholism is drastically under-reported in ICSRs, and the conditioning unlikely to be effective in closing the backdoor path - information would still flow through the reports from alcoholic patients, not reporting alcoholism.


``` r
alcoholism &lt;- c("alcoholism","alcohol problem","alcoholic encephalopathy","alcoholic coma",
                "alcohol use disorder","alcoholic ketoacidosis","ex-alcohol user",
                "alcoholic pancreopathy","ex-alcoholic","alcoholic pancreatitis",
                "prophylaxis against alcoholic withdrawal syndrome",
                "alcoholic seizure","alcohol rehabilitation","alcohol withdrawal syndrome",
                "alcohol detoxification","alcohol use","social alcohol drinker",
                "polyneuropathy alcoholic","hepatitis alcoholic","gastritis alcoholic haemorrhagic",
                "gastritis alcoholic","fatty liver alcoholic","cirrhosis alcoholic",
                "cardiomyopathy alcoholic","amblyopia alcohol","alcoholic psychosis",
                "alcoholic pseudo cushing's syndrome","alcoholic liver disease",
                "alcoholic hangover","alcohol poisoning","alcohol induced persisting dementia",
                "alcohol abuse")
pids_alcoholism &lt;- union(Reac[pt%in%alcoholism]$primaryid,Indi[indi_pt%in%alcoholism]$primaryid)
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"alcoholism"=list(pids_alcoholism))#,
                  #   "non-alcoholism"=list(setdiff(Demo$primaryid,pids_alcoholism)))

disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="quetiapine",
                                    reac_selected = "osteoporosis",
                                    meddra_level = "pt",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("non-alcoholism","main","alcoholism"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;        nested               label_IC
#&gt;         &lt;ord&gt;                 &lt;char&gt;
#&gt; 1:       main 0.59 (0.44-0.69) [526]
#&gt; 2: alcoholism  0.21 (-1.86-1.41) [3]</code></pre>
<p>``{r Forest_comorb, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_comorb-1.png”, : Cannot
find the file(s): “causal_inference-Forest_comorb-1.png”</p>
<pre><code>
#### Confounding by differential prescription

![Confounding by differential prescription. For example, the medication (nivolumab) is less frequently prescribed in the population at risk for the outcome (premature delivery), potentially hiding the association.](causal_inference-diff_prescr.png)
A third example concerns confounding by differential prescription (allocation bias/channelling bias). The statistical dependence (or its lack of) is here generated by the existence of differential prescriptive habits in subgroups with different susceptibility to the event. If we investigate the relation between nivolumab and risk of preterm birth, we do find a negative statistical association (grey estimate), that is, no evidence of a positive association, according to pharmacovigilance standards (see footnote 2). However, pregnancy is associated with both the risk of the event (no pregnancy, no preterm delivery), and a lower use of nivolumab. The drug is indeed unlikely to be used during pregnancy due to lower probability of cancer in fertile age and lack of safety evidence for this population (partial contraindication). Drawing the DAG, we can infer that confounding would push towards a negative association (odd number of minus signs): nivolumab is less used in pregnancy and therefore is less co-reported with preterm birth. Restricting to cases of pregnancy, a positive association between nivolumab and preterm birth emerges (gold estimate). In this instance, not conditioning on the confounder would have led to missing a potential safety signal during signal detection.


``` r
pids_pregnancy_indi &lt;- unique(Indi[indi_pt%in%MedDRA[soc=="pregnancy, puerperium and perinatal conditions"]$pt]$primaryid)
pids_pregnancy_reac &lt;- unique(Reac[pt%in%MedDRA[soc=="pregnancy, puerperium and perinatal conditions"]$pt]$primaryid)
pids_pregnancy &lt;- union(pids_pregnancy_indi,pids_pregnancy_reac)

restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"pregnancy"=list(pids_pregnancy))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="nivolumab",
                                    reac_selected = list("preterm birth"=list("premature baby","premature delivery")),
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("main","pregnancy"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;       nested                 label_IC
#&gt;        &lt;ord&gt;                   &lt;char&gt;
#&gt; 1:      main -2.11 (-2.62--1.74) [42]
#&gt; 2: pregnancy    1.04 (0.53-1.41) [42]</code></pre>
<p>``{r Forest_prescr, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_prescr-1.png”, : Cannot
find the file(s): “causal_inference-Forest_prescr-1.png”</p>
<pre><code>

#### Confounding by coprescription

![Confounding by coprescription. For example, the medication (hydrochlorothiazide) is frequently prescribed together with another medication (valsartan) that causes the outcome (dysphonia), potentially resulting in a spurious association.](causal_inference-coprescr.png)

Confounding due to co-prescription is generated by the frequent coprescription of the drug of interest with a drug that is the real cause of the event. When examining the potential link between hydrochlorothiazide and dysphonia, it is important to consider that hydrochlorothiazide is commonly co-prescribed with valsartan, which causes dysphonia through coughing. By restricting to reports mentioning valsartan (gold estimate), we can infer that the observed association between the drug and the event (grey estimate) is likely solely due to the co-prescription with valsartan. In both confounding by comorbidity and by co-prescription we see again that restricting to reports not recording the value (blue estimate) does not seem to affect the IC estimate, likely due to residual unaccounted confounding.


``` r
pids_valsartan &lt;- unique(Drug[substance=="valsartan"]$primaryid)

restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"valsartan"=list(pids_valsartan))#,
                     #"non-valsartan"=list(setdiff(Demo$primaryid,pids_valsartan)))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="hydrochlorothiazide",
                                    reac_selected = "dysphonia",
                                    meddra_level = "pt",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("non-valsartan","main","valsartan"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;       nested                label_IC
#&gt;        &lt;ord&gt;                  &lt;char&gt;
#&gt; 1:      main 0.91 (0.83-0.97) [1678]
#&gt; 2: valsartan 0.01 (-0.23-0.18) [193]</code></pre>
<p>``{r Forest_copresc, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_copresc-1.png”, :
Cannot find the file(s): “causal_inference-Forest_copresc-1.png”</p>
<pre><code>
#### Confounding by demographic factor

![Confounding by demographic. For example, the medication (trastuzumab) is mostly prescribed in females with breast cancers that are not at risk for the outcome (prostate cancer), potentially deflating the IC.](causal_inference-demo_conf.png)
Lastly, demographic factors can also introduce confounding. For instance, when exploring the potential link between trastuzumab and prostate cancer, we must consider that among all individuals receiving trastuzumab (primarily for breast cancer), only a small subset is male and thus at risk of prostate cancer. This demographic confounding can decrease the statistical dependence (grey estimate), although it remains statistically not significant when focusing solely on males (gold estimate).


``` r
pids_male &lt;- Demo[sex=="M"]$primaryid

restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"male"=list(pids_male))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="trastuzumab",
                                    reac_selected = "prostate cancer",
                                    meddra_level = "pt",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("main","male"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;    nested                label_IC
#&gt;     &lt;ord&gt;                  &lt;char&gt;
#&gt; 1:   main  -6.69 (-9.28--5.3) [2]
#&gt; 2:   male -3.77 (-6.36--2.38) [2]</code></pre>
<p>``{r Forest_demo, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_demo-1.png”, : Cannot
find the file(s): “causal_inference-Forest_demo-1.png”</p>
<pre><code><span></span>
<span><span class="co">### Collider bias</span></span>
<span></span>
<span><span class="co">#### Collider bias by outcome</span></span>
<span></span></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-collider_outc.png”, : Cannot
find the file(s): “causal_inference-collider_outc.png”</p>
<pre><code>
If we investigate the causal dependence between Chimeric Antigen Receptor T (CAR-T) therapy and infections, we find a positive statistical association (grey estimate). Were we to limit our analysis to reports that mention death as one of the outcomes we would find an even stronger association (red estimate). This is because CAR-T therapies reduce mortality, and infections themselves may lead to mortality, thus restricting to reports mentioning death opens a path and likely introduces a positive distortion into the data. Again, were we to restrict to reports not mentioning death, we would produce a noisy inference (blue estimate).


``` r
pids_death &lt;- unique(Outc[outc_cod=="DE"]$primaryid)
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"Dead"=list(pids_death))#,"non_Dead"=list(setdiff(unique(Demo$primaryid),pids_death)))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="axicabtagene ciloleucel",
                                    reac_selected = "infections and infestations",
                                    meddra_level = "soc",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("non_Dead","main","Dead"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;    nested                label_IC
#&gt;     &lt;ord&gt;                  &lt;char&gt;
#&gt; 1:   main 0.52 (0.41-0.59) [1047]
#&gt; 2:   Dead     1 (0.84-1.12) [416]</code></pre>
<p>``{r Forest_outc, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“red”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_outc-1.png”, : Cannot
find the file(s): “causal_inference-Forest_outc-1.png”</p>
<pre><code><span></span>
<span></span>
<span><span class="co">#### Collider bias by prophylaxis</span></span>
<span></span></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-collider_proph.png”, : Cannot
find the file(s): “causal_inference-collider_proph.png”</p>
<pre><code>If we investigate the relation between aspirin and gastric ulcer, we find a positive statistical association (grey estimate). However, we should be wary of conditioning on whether the report also mentions proton pump inhibitors (PPIs). PPIs can indeed be used to treat gastric ulcer or – if administered together with aspirin - to prevent it. In this case, if we condition on the use of proton pump inhibitors (red estimate), the expected association between aspirin and gastric ulcer is going to be biased towards the null: among patients taking PPIs, those not taking aspirin are more likely to not be in prophylaxis and therefore to already have gastric ulcer. Therefore, by conditioning on a collider we risk losing a potential signal. Once more, we observe that restricting to reports that do not mention PPIs (blue estimate) has minimal impact on the IC estimate. This is likely because the reporting rate of PPIs when they are not the suspected drug is presumed to be very low.


``` r
pids_PPI &lt;- unique(Drug[substance%in%ATC[Class4=="Proton pump inhibitors"]$substance]$primaryid)

restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"PPI"=list(pids_PPI))#,"non_PPI"=list(setdiff(unique(Demo$primaryid),pids_PPI)))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="acetylsalicylic acid",
                                    reac_selected = "gastric ulcer",
                                    meddra_level = "pt",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("non_PPI","main","PPI"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;    nested                label_IC
#&gt;     &lt;ord&gt;                  &lt;char&gt;
#&gt; 1:   main 1.91 (1.85-1.95) [2852]
#&gt; 2:    PPI  0.15 (0.03-0.24) [746]</code></pre>
<p>``{r Forest_proph, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“red”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_outc-1.png”, : Cannot
find the file(s): “causal_inference-Forest_outc-1.png”</p>
<pre><code><span></span>
<span><span class="co">#### Collider bias by double mechanism</span></span>
<span></span></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-collider_double.png”, : Cannot
find the file(s): “causal_inference-collider_double.png”</p>
<pre><code>Another scenario arises when we are aware that a drug induces an event, and the suspected reaction itself may contribute to that event (i.e., a potential indirect effect of the drug). For example, if we are interested in the causal dependence between Glucagone Like Peptide GLP 1-agonists and anxiety, their statistical association is negative (grey estimate). However, we have to be wary that both GLP 1-agonists and anxiety cause weight-loss. Therefore, if we were to condition on weight-loss we would open a path and introduce a negative collider bias (red estimate). In this case, the direction of the statistical association does not change, but we can anticipate and then confirm the shift towards a more negative estimate. Once again, restricting to reports that do not mention weight loss does not change the outcome (blue estimate).


``` r
pids_weight &lt;- union(Reac[pt%in%c("weight decreased")]$primaryid,
                     Indi[indi_pt%in%c("weight decreased")]$primaryid)
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"weight loss"=list(pids_weight))#
                     #,"non-weight loss"=list(setdiff(Demo$primaryid,pids_weight)))

disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected=list("GLP1-agonist"=list("liraglutide","exenatide","semaglutide","dulaglutide")),
                                    reac_selected = "anxiety disorders and symptoms",
                                    meddra_level = "hlgt",
                                                         restriction = t_pids)[,nested:=t_name]
                                    disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("non-weight loss","main","weight loss"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;         nested                   label_IC
#&gt;          &lt;ord&gt;                     &lt;char&gt;
#&gt; 1:        main -0.26 (-0.31--0.23) [5114]
#&gt; 2: weight loss  -1.31 (-1.42--1.23) [906]</code></pre>
<p>``{r Forest_double, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“red”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_double-1.png”, : Cannot
find the file(s): “causal_inference-Forest_double-1.png”</p>
<pre><code>
### Information bias
In a report the information about the presence or absence of an exposure, outcome, confounder, or collider could be affected by measurement error. The deriving bias is known as information component, and can be similarly addressed with the strategies described above. Here some examples.

#### Ascertainment bias

![Bias resulting from measurement error can be introduced by the exposure to a medication (clozapine) increasing the probability of diagnosing the outcome (hyperkalemia).](causal_inference-ascertainment.png)
Ascertainment bias occurs when the exposure to a drug determines an increased attention and reporting rate for a specific event. Taking clozapine, because of the risk of agranulocytosis, results in frequent blood tests and higher probability of detecting and reporting hyperkalaemia. For this reason, the analysis on the entire population (grey estimate), gives a higher (but still not significant) IC than when we restrict to reports recording any investigation (gold estimate).


``` r
pids_investigations &lt;- Reac[pt%in%MedDRA[soc=="investigations"]$pt]$primaryid
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"investigation"=list(pids_investigations))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="clozapine",
                                    reac_selected = "hyperkalaemia",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("main","investigation"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;           nested                 label_IC
#&gt;            &lt;ord&gt;                   &lt;char&gt;
#&gt; 1:          main  -1.7 (-2.13--1.39) [60]
#&gt; 2: investigation -2.25 (-2.94--1.77) [24]</code></pre>
<p>``{r Forest_ascert, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_ascert-1.png”, : Cannot
find the file(s): “causal_inference-Forest_ascert-1.png”</p>
<pre><code>
#### Surrogate confounder and missing data

![Missing data can distort the results because of an information bias. We can take into account multiple surrogate variables to reduce the distortion generated by missing data.](causal_inference-missing.png)

Finally, missing data is a common issue of ICSRs because only the suspected drug and reaction are mandatory fields in the reporting system. For instance, when investigating whether cisplatin causes thrombosis, we find an association (grey estimate) but we recognize that cancer is a likely common cause for both exposure and outcome. We may condition on the confounder either restricting to reports recording cancer among the indications or to reports recording any antineoplastic agent (blue estimates), but this may lead to a small sample and reduced accuracy because of missing information. To address this challenge, we might restrict to reports satisfying any of the two inclusion criteria (gold estimate).


``` r
pids_onco_indi &lt;- Indi[indi_pt%in%MedDRA[soc=="neoplasms benign, malignant and unspecified (incl cysts and polyps)"]$pt]$primaryid
pids_onco_drug &lt;- Drug[substance%in%c(ATC[Class2=="Antineoplastic"]$substance,
                                      "navitoclax")]$primaryid
pids_onco_drugindi &lt;- union(pids_onco_drug,pids_onco_indi)
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"onco_drug"=list(pids_onco_drug),"onco_indi"=list(pids_onco_indi),"onco_drugindi"=list(pids_onco_drugindi))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="cisplatin",
                                    reac_selected = "thrombosis",
                                    meddra_level = "pt",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("onco_drug","onco_indi","main","onco_drugindi"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;           nested                  label_IC
#&gt;            &lt;ord&gt;                    &lt;char&gt;
#&gt; 1:          main    0.43 (0.26-0.55) [376]
#&gt; 2:     onco_drug    0.19 (0.02-0.32) [376]
#&gt; 3:     onco_indi -0.52 (-0.71--0.38) [300]
#&gt; 4: onco_drugindi -0.24 (-0.41--0.11) [376]</code></pre>
<p>``{r Forest_miss, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_miss-1.png”, : Cannot
find the file(s): “causal_inference-Forest_miss-1.png”</p>
<pre><code>
### Reporting bias

Reporting biases are instead characterized by the fact that specific episodes of drug-event combination may have not been reported at all, and that this preferential reporting may have affected differently cases and non-cases.
Up to this point, our discussion has assumed direct access to drug exposure and event incidence rates and therefore mostly ignored that ICSRs are reports likely to be generated through biased measurement processes. Indeed, many drug-event co-occurrences are never reported (underreporting) due, for instance, to lack of awareness or motivation in the patient and/or clinician, or to the complexity and time demands in submitting a report. Perhaps even more worrisome, drug exposure without adverse events is not reported, nor are events occurring without drug administration. To account for such scenarios, DAGs have to incorporate biases that differentially affect baseline reported occurrences and cases of interest. In the following DAGs, we will accordingly introduce measurements of underlying variables, denoted with an asterisk \*, and partly deviate from more traditional DAG conventions. In particular, disproportionality can be directly assessed if we know how often drug D is used – with and without the occurrence of the event E - and how often event E occurs – with and without the administration of D. However, we do not have access to such data. Rather, disproportionality analyses calculate measures of drug use (D) relying on the number of reports with the drug and event of interest (DE) and the number of reports with the drug of interest and other events (DnE, rather than directly counting patients taking the drug but not experiencing the event), compared to reports (of other drug-event occurrences) not mentioning the drug (nD). Analogously, we do not have access to the occurrence of event E, but we rely on the number of reports with the drug and event of interest (DE) and reports of the same event co-occurring with other drugs but D (nDE), compared to reports not mentioning the event (nE). These measurements are used to calculate the IC as a measure of association between D and E\* but, if they present measurement errors (reporting biases, R), they can introduce inaccuracies and imprecision into the inference. The utility of the IC as a surrogate measure of association between the drug and the event is based on the key assumption that any reporting bias will equally affect the reporting of all drugs and events (independent reporting bias). The problem arises when there is dependent reporting bias, differentially affecting the four different measures (DE, nDE, DnE, nDnE). We can distinguish positive and negative reporting biases based on whether they amplify (i.e., increase DE\* and/or nDnE) or dampen the IC (i.e., increase DnE\* and/or nDE). We can tackle reporting biases by restricting our analyses to the reports not affected by the biased measurement error, or in principle – although not done yet in practice – explicitly include estimates of measurement error in the model as mitigation factors. Reporting rates can vary depending on report type (e.g., spontaneous, solicited, literature case report), reporter’s expertise (misclassification bias, e.g., use of ambiguous terms to refer to speech impairment) and diverse reporting habits among different reporter types (e.g., medical doctors, patients, lawyers), regulatory systems, and settings of use. The variability in the way pharmacovigilance officers code verbatim events recorded by patients to MedDRA might further affect the downstream statistical analyses. When anticipating such differential effects, it may be appropriate to consider restrictions, even if predicting the exact direction of the distortion is often challenging: e.g., the severity of an event might increase its reporting rate, and therefore both DE (which inflates the IC) and nDE\* (which deflates the IC). For the better investigated reporting biases, the exact direction of the distortion can be predicted.

#### Notoriety bias

</code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-collider_double.png”, : Cannot
find the file(s): “causal_inference-collider_double.png”</p>
<pre><code>
Let us take the example of the notoriety bias, which may affect both healthcare professionals and patients. When regulatory warnings are issued, healthcare professionals may become more aware of and inclined to report specific drug-event combinations. Similarly, a few highly publicized cases can attract media attention, leading the public to higher awareness and inclination to report. This inflates the DE\* reporting rate compared to reporting just the drug or the event alone, and therefore inflates the IC (grey estimate). To address this bias, we can, for instance, restrict the DPA to the reports collected before the regulatory warning, if enough cases are available, thereby conditioning on the source of the bias (gold estimate). As a proof of concept, we can restrict to the cases following the regulatory warning and obtain an inflated statistical dependence (blue estimate).


``` r
pids_warning &lt;- Demo[init_fda_dt&lt;20160503]$primaryid
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"pre-warning"=list(pids_warning),
                     "post-warning"=setdiff(Demo$primaryid,pids_warning))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="aripiprazole",
                                    reac_selected = "hypersexuality",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}
disproportionality_df &lt;- disproportionality_df[,nested:=factor(nested, levels=c("post-warning","main","pre-warning"),ordered=TRUE)]
disproportionality_df[,.(nested,label_IC)]
#&gt;          nested               label_IC
#&gt;           &lt;ord&gt;                 &lt;char&gt;
#&gt; 1:         main 5.19 (5.03-5.32) [383]
#&gt; 2:  pre-warning  2.68 (1.84-3.27) [16]
#&gt; 3: post-warning 5.45 (5.28-5.58) [367]</code></pre>
<p>``{r Forest_notor, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_notor-1.png”, : Cannot
find the file(s): “causal_inference-Forest_notor-1.png”</p>
<pre><code>
#### Lawyers reports

![Reporting bias can be introduced by a consistent input of lawyers report for a specific drug (aripiprazole) - event (gambling) combination.](causal_inference-lawyer.png)
The notoriety bias and the similarly acting precautionary bias (e.g., reports from patient support programs, with increased reporting rate) could be characterized as differential underreporting: more DE are reported – i.e., less underreported - than background cases. Conversely, reports may even occur in the lack of an actual event – as in the case of superficial diagnostic verification (e.g., reporting drug-induced liver injury without verifying all diagnostic criteria) and of malicious reporting (as speculated for court litigations) – or may proliferate from a single report into many duplicates. This differential reporting of DE\* can be dealt with conditioning on the source of the bias: e.g., removing reports by lawyers and duplicates. For instance, when investigating the causal dependence between aripiprazole and gambling, we find a positive association (grey estimate). However, due to potential malicious reporting by lawyers within court litigation, this result may not be reliable. To inspect this potential bias, we restrict to reports not produced by lawyers and we find a smaller but still significant association (gold estimate). As proof of concept, we can restrict to reports produced by lawyers and there we find a bigger association (blue estimates). It’s important to note that all reports are valuable, as illustrated by the FDA warning for aripiprazole-induced impulse control disorders in 2016, which relied on reports by patients and lawyers (REF DAA partial). Hence, all reports should be encouraged, and considerations on the potential bias should be limited to the analysis and not to data collection. Based on the DAG, sensitivity quantitative and qualitative analyses can be performed by restricting to specific subpopulations to account for expected biases. When conducting such sensitivity analyses, both the raw disproportionality result and the result of the sensitivity analysis should be reported and discussed together.


``` r
pids_lawyers &lt;- Demo[occp_cod=="LW"]$primaryid
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"lawyers"=list(pids_lawyers),
                     "non-lawyers"=setdiff(Demo$primaryid,pids_lawyers))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="aripiprazole",
                                    reac_selected = "gambling disorder",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df[,.(nested,label_IC)]
#&gt;         nested                label_IC
#&gt;         &lt;char&gt;                  &lt;char&gt;
#&gt; 1:        main 6.27 (6.19-6.32) [2014]
#&gt; 2:     lawyers 7.68 (7.58-7.75) [1118]
#&gt; 3: non-lawyers  5.56 (5.45-5.64) [896]</code></pre>
<p>``{r Forest_lawyer, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“blue”,“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_lawyer-1.png”, : Cannot
find the file(s): “causal_inference-Forest_lawyer-1.png”</p>
<pre><code>
#### Masking

Masking/cloaking is an additional example of reporting bias and can take the form of a drug-competition bias (increased reporting rate for the same event with other drugs nDE\*) or an event competition bias (increased reporting rate for the same drug with other events DnE\*), which may also derive from notoriety biases sharing with DE exclusively the drug or the event. This bias likely dampens the IC and can be tackled by removing from the database reports of the competing drug-event pair. The fact that these distortions induced by masking are not so evident compared to the effect of other biases presented in this manuscript is in agreement with previous studies that question its importance.

##### Drug competition bias

![Reporting bias can be introduced by competition because of the consistent reporting of the same event (gambling disorder) with another drug (dopamine agonists).](causal_inference-lawyer.png)
Investigating the causal dependence between cariprazine and gambling, we find a statistical dependence (grey estimate) which nonetheless increases even more when we remove reports of gambling with the competing dopamine agonists (gold estimate).


``` r
pids_unmasked &lt;- setdiff(Demo$primaryid,Drug[substance%in%ATC[Class4=="Dopamine agonists"]$substance]$primaryid)
pids_unmasked &lt;- setdiff(Demo$primaryid,intersect(Drug[substance%in%ATC[Class4=="Dopamine agonists"]$substance]$primaryid,Reac[pt=="gambling disorder"]$primaryid))
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"unmasked"=list(pids_unmasked))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="cariprazine",
                                    reac_selected = "gambling disorder",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df[,.(nested,label_IC)]
#&gt;      nested              label_IC
#&gt;      &lt;char&gt;                &lt;char&gt;
#&gt; 1:     main 3.23 (2.43-3.78) [18]
#&gt; 2: unmasked    3.79 (3-4.34) [18]</code></pre>
<p>``{r Forest_drug_comp, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_drug_comp-1.png”, :
Cannot find the file(s): “causal_inference-Forest_drug_comp-1.png”</p>
<pre><code>
##### Event competition bias

Similarly, when investigating the causal dependence between warfarin and skin discoloration we observe a statistical dependence (grey estimate) which even increase when we remove reports of warfarin with the competing event bleeding (gold estimate).


``` r
pids_unmasked &lt;- setdiff(Demo$primaryid,intersect(Reac[pt%in%MedDRA[grepl("bleeding|haemorrhage",pt)]$pt]$primaryid,Drug[substance=="warfarin"]$primaryid))
restrictions &lt;- list("main"=list(unique(Demo$primaryid)),"unmasked"=list(pids_unmasked))
disproportionality_df &lt;- data.table()
for (n in 1:length(restrictions)){
  t &lt;- restrictions[n]
  t_name &lt;- names(t)
  t_pids &lt;- unlist(t)
  df &lt;- disproportionality_analysis(drug_selected="warfarin",
                                    reac_selected = "skin discolouration",
                                    restriction = t_pids)[,nested:=t_name]
  disproportionality_df &lt;- rbindlist(list(disproportionality_df,df),fill = TRUE)
}

disproportionality_df[,.(nested,label_IC)]
#&gt;      nested               label_IC
#&gt;      &lt;char&gt;                 &lt;char&gt;
#&gt; 1:     main 0.99 (0.88-1.06) [967]
#&gt; 2: unmasked    1 (0.88-1.08) [835]</code></pre>
<p>``{r Forest_event_comp, fig.height=4, fig.width=12, fig.show=“hide”}
render_forest(disproportionality_df,nested =
“nested”,nested_colors=c(“gray45”,“goldenrod”))</p>
<pre><code></code></pre>
<p>#&gt; Error in
knitr::include_graphics(“causal_inference-Forest_event_comp-1.png”, :
Cannot find the file(s): “causal_inference-Forest_event_comp-1.png”
```</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michele Fusaroli, Valentina Giunchi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
