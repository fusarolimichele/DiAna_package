<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>v02_Disproportionality_Analysis • DiAna</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="v02_Disproportionality_Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DiAna</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01_Start_Subproject.html">v01_Start_Subproject</a></li>
    <li><a class="dropdown-item" href="../articles/v02_Disproportionality_Analysis.html">v02_Disproportionality_Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fusarolimichele/DiAna_package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>v02_Disproportionality_Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fusarolimichele/DiAna_package/blob/main/vignettes/articles/v02_Disproportionality_Analysis.Rmd" class="external-link"><code>vignettes/articles/v02_Disproportionality_Analysis.Rmd</code></a></small>
      <div class="d-none name"><code>v02_Disproportionality_Analysis.Rmd</code></div>
    </div>

    
    
<p>This tutorial will show you how to perform simple and advanced
disproportionality analyses. While this tutorial recursively redefine
the object of study and the background reference group, it does so to
provide a pedagogical flow. It is recommended to design the analysis a
priori, and clearly document and justify any deviation from the original
design.</p>
<div class="section level2">
<h2 id="requisites">Requisites<a class="anchor" aria-label="anchor" href="#requisites"></a>
</h2>
<p>This tutorial requires that you have first:</p>
<ol style="list-style-type: decimal">
<li><p>installed R and R Studio,</p></li>
<li><p>installed the DiAna package,</p></li>
<li><p>and set up your project folder.</p></li>
</ol>
<p>Otherwise get back to the ReadMe and follow the instructions.</p>
<p>It is also recommended, but not necessary, that you have read the
previous vignettes.</p>
</div>
<div class="section level2">
<h2 id="start-the-subproject">Start the subproject<a class="anchor" aria-label="anchor" href="#start-the-subproject"></a>
</h2>
<p>From the DiAna main project, we open a new R script and run the
snippet ‘new_FAERS_project’ to set up a project.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information -----------------------------------------------------------------</span></span>
<span><span class="co">## Project title --------------------------------------------------------------</span></span>
<span><span class="co">### v02_Disproportionality analysis</span></span>
<span><span class="co">## Data -----------------------------------------------------------------------</span></span>
<span><span class="co">### FDA Adverse Event Reporting System Quarterly Data</span></span>
<span></span>
<span><span class="co">## Authors --------------------------------------------------------------------</span></span>
<span><span class="co">### Michele Fusaroli</span></span>
<span></span>
<span><span class="co">## Version --------------------------------------------------------------------</span></span>
<span><span class="co">### Set up: 2024-07-29</span></span>
<span><span class="co">### Last update: 2024-07-29</span></span>
<span><span class="co">### DiAna version: 2.1.0</span></span>
<span></span>
<span><span class="co"># Set up ----------------------------------------------------------------------</span></span>
<span><span class="co">## upload DiAna ---------------------------------------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fusarolimichele/DiAna_package" class="external-link">DiAna</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Project_path ---------------------------------------------------------------</span></span>
<span><span class="va">DiAna_path</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">project_name</span> <span class="op">&lt;-</span> <span class="st">"v02_Disproportionality_Analysis"</span></span>
<span><span class="va">project_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DiAna_path</span>, <span class="st">"/projects/"</span>, <span class="va">project_name</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">project_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">project_path</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">project_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">project_path</span>, <span class="st">"/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## FAERS_version --------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">FAERS_version</span> <span class="op">&lt;-</span> <span class="st">"24Q1"</span></span>
<span></span>
<span><span class="co">## Import data ----------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"DRUG"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid   drug_seq       substance role_cod</span></span>
<span><span class="co">#&gt;               &lt;num&gt;      &lt;int&gt;          &lt;fctr&gt;    &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4261825 1004486228        atropine        C</span></span>
<span><span class="co">#&gt;        2:   4261825 1004486228   diphenoxylate        C</span></span>
<span><span class="co">#&gt;        3:   4262057 1004487206     amoxicillin       PS</span></span>
<span><span class="co">#&gt;        4:   4262057 1004487206 clavulanic acid       PS</span></span>
<span><span class="co">#&gt;        5:   4262057 1004487210        macrogol        C</span></span>
<span><span class="co">#&gt;       ---                                              </span></span>
<span><span class="co">#&gt; 69763501: 992001227        580      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763502: 992001227        581      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763503: 992001227        582      loratadine       SS</span></span>
<span><span class="co">#&gt; 69763504: 992001227        586       magnesium        C</span></span>
<span><span class="co">#&gt; 69763505: 992001227        587       magnesium        C</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"REAC"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid                            pt drug_rec_act</span></span>
<span><span class="co">#&gt;               &lt;num&gt;                         &lt;ord&gt;        &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4204616                abdominal pain         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        2:   4204616          heart rate increased         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        3:   4204616                        nausea         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        4:   4204616                       pyrexia         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        5:   4204616            uterine tenderness         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;       ---                                                     </span></span>
<span><span class="co">#&gt; 52222720: 237079291         chemical burn of skin         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222721: 237079291    toxicity to various agents         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222722: 237079291                          scar         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222723: 237203351 injection site discolouration         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 52222724: 237203351       injection site bruising         &lt;NA&gt;</span></span>
<span></span>
<span><span class="co">## Input files ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Output files ---------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Definitions ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Reference groups -----------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Descriptive analysis -------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ------------------------------------------------</span></span>
<span></span>
<span><span class="co">## Case by case analysis ------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="disproportionality-analysis">Disproportionality analysis<a class="anchor" aria-label="anchor" href="#disproportionality-analysis"></a>
</h2>
<div class="section level4">
<h4 id="basic-application">Basic application<a class="anchor" aria-label="anchor" href="#basic-application"></a>
</h4>
<p>Let’s explore the disproportionality_analysis function. We are
investigating the possibility of a role of “aripiprazole” in causing
“impulse control disorder”, and we therefore draft the definitions of
our objects of study.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span><span class="va">drug_selected</span> <span class="op">&lt;-</span> <span class="st">"aripiprazole"</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="st">"impulse control disorder"</span></span></code></pre></div>
<p>Already using these simple definitions, we can ran the simplest
disproportionality analysis: we want to save in an object called
disproportionality_df, the results of a disproportionality analysis on
the drug and reaction specified.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As you run the command a message appears in the console: “Not all the
events selected were found in the database, check the following terms
for any misspelling or alternative nomenclature: impulse control
disorder. Would you like to revise the query? (Yes/no/cancel)”. This
message implies that the exact term “impulse control disorder” does not
exists in our database. How can we proceed? We write “Yes” in the
console and run the command with “return”. The function warns us once
again to revise our query, or definition of the object of study. How can
we check the correct spelling? We can look into the MedDRA if we have
it, or more quickly search directly in the database with the following
command, that could be run just in the console since we do not need to
keep it in our script.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Reac</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"pt"</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">N</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"impuls"</span>, <span class="va">pt</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;                          pt     N</span></span>
<span><span class="co">#&gt;                       &lt;ord&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      impulsive behaviour  3264</span></span>
<span><span class="co">#&gt; 2: impulse-control disorder  1733</span></span></code></pre></div>
<p>The previous command can be read as: “within the database Reac, count
how many times (.N) each preferred term occurs (by=”pt”). Then order the
pt by decreasing N (order(-N)). Finally, filter only the rows with the
pattern “impuls” in the pt. As you can see there are two terms that we
should plausibly include in out analysis: impulsive behaviour, which is
the term most used even if we did not even consider it, and
“impulse-control disorder” which is the term we wanted to consider but
has also a dash between the first two words. First, let’s fix the
definition. We get back to the definition section of our script and we
fix it including the dash in the reaction pt as follows and we rerun the
disproportionality analysis:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span><span class="va">drug_selected</span> <span class="op">&lt;-</span> <span class="st">"aripiprazole"</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="st">"impulse-control disorder"</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;       substance                    event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper</span></span>
<span><span class="co">#&gt;          &lt;fctr&gt;                    &lt;ord&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: aripiprazole impulse-control disorder   286 111261 111547  1447  1733 17485485      31.06     27.28     35.25</span></span>
<span><span class="co">#&gt;    IC_median IC_lower IC_upper                 label_ROR               label_IC Bonferroni ROR_signal IC_signal</span></span>
<span><span class="co">#&gt;        &lt;num&gt;    &lt;num&gt;    &lt;num&gt;                    &lt;char&gt;                 &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt;</span></span>
<span><span class="co">#&gt; 1:      4.64     4.44     4.78 31.06 (27.28-35.25) [286] 4.64 (4.44-4.78) [286]       TRUE        SDR       SDR</span></span></code></pre></div>
<p>This time no error appears, and after few seconds we can see that our
environment (window pane usually on the upper right) has been populated
with a dataset called disproportionalitY_df. Calling the name of the
object prints it in the console, and we can see that the object is now a
dataset with one row (per drug-event combination) and 19 columns,
including the name of the substance and the event, the instances of the
contingency table, the median and 95% confidence interval of the
Reporting Odds Ratio ROR and of the Information component, these same
results summarised as a string in the following format “median (lower
limit-upper limit) [N cases]”. A Bonferroni column that specifies
whether the ROR was still significant after correcting for multiple
comparison, and two columns that summarise whether a signal exists (SDR)
or not (no SDR) or exists but disappear at the correction for multiple
comparison (weak SDR). In this case we have found a signal of
disproportionate reporting using both the analyses. These columns exist
to simplify input to further functions, such as, for example, the
visualization using render_forest.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/render_forest-1.png" alt="plot of chunk render_forest"><div class="figcaption">plot of chunk render_forest</div>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, index <span class="op">=</span> <span class="st">"ROR"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/render_forest-2.png" alt="plot of chunk render_forest"><div class="figcaption">plot of chunk render_forest</div>
</div>
<p>In these forest plots we see on the x axis the information component
(by default) or the ROR if we specify it in the index parameter. The
median is shown using the dot, whose size is proportional to the number
of cases. The 95% confidence interval is shown by the line. A dashed
vertical axis (on the 0 for the IC and on the 1 for the ROR) highlights
the threshold of statistical significance, compared to which the lower
limit of the confidence interval must be higher to identify a signal of
disproportionate reporting. In this case, we identified a clear signal
of disproportionate reporting using both methods.</p>
</div>
<div class="section level4">
<h4 id="extend-queries">Extend queries<a class="anchor" aria-label="anchor" href="#extend-queries"></a>
</h4>
<p>As we said before, the definition is not exhaustive, and we risk
missing many cases of impulsivity which used a different PT from
“impulse-control disorder”. In fact those undetected cases will be part
of the background reference group and potentially distort the results.
How can we extend the definition? Let’s go back to the definition
paragraph and add other interesting terms to the definition of
impulse-control disorder, using a named list.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span><span class="va">drug_selected</span> <span class="op">&lt;-</span> <span class="st">"aripiprazole"</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"impulse-control disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"impulse-control disorder"</span>,</span>
<span>  <span class="st">"impulsive behaviour"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;       substance                    event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper</span></span>
<span><span class="co">#&gt;          &lt;fctr&gt;                   &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: aripiprazole impulse-control disorder   701 110846 111547  4258  4959 17482674      25.94     23.94     28.13</span></span>
<span><span class="co">#&gt;    IC_median IC_lower IC_upper                 label_ROR               label_IC Bonferroni ROR_signal IC_signal</span></span>
<span><span class="co">#&gt;        &lt;num&gt;    &lt;num&gt;    &lt;num&gt;                    &lt;char&gt;                 &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt;</span></span>
<span><span class="co">#&gt; 1:      4.45     4.33     4.54 25.94 (23.94-28.13) [701] 4.45 (4.33-4.54) [701]       TRUE        SDR       SDR</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/extend_query-1.png" alt="plot of chunk extend_query"><div class="figcaption">plot of chunk extend_query</div>
</div>
<p>You see now that the number of cases has increased from 286 to 701,
and we still find a SDR.</p>
</div>
<div class="section level4">
<h4 id="multiple-queries">Multiple queries<a class="anchor" aria-label="anchor" href="#multiple-queries"></a>
</h4>
<p>Taking this further, we should consider that this impulsivity
manifests often as pervasive behaviors, such as gambling, compulsive
shopping, hyperphagia, and hypersexuality. Here below we add an extended
query for impulse-control disorders that we refined over the years (see
Parkinsonism and Related Disorders 90 (2021) 79–83 for the documentation
of how we obtained the first definition combining a scoping review and
disproportionality analysis). We also use a further feature of the
disproportionality_analysis function and run the analysis in parallel on
the several possible behavioral manifestations of impulsivity, just
adding other named elements to the list.</p>
<p>Specifically, we first define a named list called ICDs with the
subqueries related with the different manifestations (e.g., gambling
disorder could be reported either as gambling disorder or as gambling),
and we then run rlist append to store in the reac_selected parameter
both the individual sub-queries and the full query. When we run the
analysis we see again the message that some of the terms
(“erotophonophilia” and “frotteurism” were not found, but in this case
we know that these terms are spelled correctly (it is just the case that
noone used them in the FAERS yet) and we run “no” in the console to let
the analysis proceed.</p>
<p>In this case we also add a further parameter to the render_forest
function, to make it print each event in a different line</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span><span class="va">drug_selected</span> <span class="op">&lt;-</span> <span class="st">"aripiprazole"</span></span>
<span></span>
<span><span class="va">ICDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"gambling disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gambling disorder"</span>, <span class="st">"gambling"</span><span class="op">)</span>,</span>
<span>  <span class="st">"hypersexuality"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"compulsive sexual behaviour"</span>,</span>
<span>    <span class="st">"hypersexuality"</span>,</span>
<span>    <span class="st">"excessive masturbation"</span>,</span>
<span>    <span class="st">"excessive sexual fantasies"</span>,</span>
<span>    <span class="st">"libido increased"</span>,</span>
<span>    <span class="st">"sexual activity increased"</span>,</span>
<span>    <span class="st">"kluver-bucy syndrome"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"paraphilia"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"erotophonophilia"</span>, <span class="st">"exhibitionism"</span>,</span>
<span>    <span class="st">"fetishism"</span>, <span class="st">"frotteurism"</span>,</span>
<span>    <span class="st">"masochism"</span>, <span class="st">"paraphilia"</span>, <span class="st">"paedophilia"</span>,</span>
<span>    <span class="st">"sadism"</span>, <span class="st">"transvestism"</span>, <span class="st">"voyeurism"</span>,</span>
<span>    <span class="st">"sexually inappropriate behaviour"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"compulsive shopping"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"compulsive shopping"</span><span class="op">)</span>,</span>
<span>  <span class="st">"hyperphagia"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"binge eating"</span>, <span class="st">"food craving"</span>, <span class="st">"hyperphagia"</span>,</span>
<span>    <span class="st">"increased appetite"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"gaming disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gaming disorder"</span><span class="op">)</span>,</span>
<span>  <span class="st">"pyromania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pyromania"</span><span class="op">)</span>,</span>
<span>  <span class="st">"kleptomania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"kleptomania"</span>, <span class="st">"shoplifting"</span><span class="op">)</span>,</span>
<span>  <span class="st">"compulsive hoarding"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"compulsive hoarding"</span><span class="op">)</span>,</span>
<span>  <span class="st">"excessive exercise"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"excessive exercise"</span><span class="op">)</span>,</span>
<span>  <span class="st">"overwork"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"overwork"</span><span class="op">)</span>,</span>
<span>  <span class="st">"poriomania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"poriomania"</span><span class="op">)</span>,</span>
<span>  <span class="st">"body-focused disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"compulsive cheek biting"</span>,</span>
<span>    <span class="st">"compulsive lip biting"</span>,</span>
<span>    <span class="st">"dermatillomania"</span>,</span>
<span>    <span class="st">"dermatophagia"</span>, <span class="st">"nail picking"</span>,</span>
<span>    <span class="st">"compulsive handwashing"</span>,</span>
<span>    <span class="st">"trichotemnomania"</span>,</span>
<span>    <span class="st">"trichotillomania"</span>, <span class="st">"onychophagia"</span>,</span>
<span>    <span class="st">"thumb sucking"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"stereotypy"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"automatism"</span>, <span class="st">"stereotypy"</span><span class="op">)</span>,</span>
<span>  <span class="st">"impulsivity"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"impulse-control disorder"</span>,</span>
<span>    <span class="st">"impulsive behaviour"</span>,</span>
<span>    <span class="st">"disinhibition"</span>, <span class="st">"behavioural addiction"</span>,</span>
<span>    <span class="st">"abnormal behaviour"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="fu">rlist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlist/man/list.append.html" class="external-link">list.append</a></span><span class="op">(</span><span class="va">ICDs</span>, <span class="st">"ICD"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ICDs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance                 event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median</span></span>
<span><span class="co">#&gt;           &lt;fctr&gt;                &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1: aripiprazole           impulsivity  2324 109223 111547 39764 42088 17447168       9.33      8.94      9.73      3.12</span></span>
<span><span class="co">#&gt;  2: aripiprazole                   ICD  5898 105649 111547 66398 72296 17420534      14.64     14.24     15.04      3.68</span></span>
<span><span class="co">#&gt;  3: aripiprazole           hyperphagia  1114 110433 111547 20160 21274 17466772       8.73      8.21      9.28      3.04</span></span>
<span><span class="co">#&gt;  4: aripiprazole     gambling disorder  2479 109068 111547  2589  5068 17484343     153.42    144.49    162.66      6.24</span></span>
<span><span class="co">#&gt;  5: aripiprazole body-focused disorder   200 111347 111547  1109  1309 17485823      28.33     24.23     32.98      4.51</span></span>
<span><span class="co">#&gt;  6: aripiprazole        hypersexuality  1119 110428 111547  3077  4196 17483855      57.56     53.72     61.60      5.36</span></span>
<span><span class="co">#&gt;  7: aripiprazole            paraphilia    92 111455 111547   511   603 17486421      28.25     22.37     35.30      4.41</span></span>
<span><span class="co">#&gt;  8: aripiprazole           kleptomania   195 111352 111547   149   344 17486783     206.74    164.42    258.48      6.18</span></span>
<span><span class="co">#&gt;  9: aripiprazole            stereotypy    60 111487 111547   942  1002 17485990       9.98      7.56     12.97      3.14</span></span>
<span><span class="co">#&gt; 10: aripiprazole    excessive exercise     1 111546 111547    84    85 17486848       1.86      0.04     10.68      0.53</span></span>
<span><span class="co">#&gt; 11: aripiprazole             pyromania     6 111541 111547    91    97 17486841      10.33      3.69     23.36      2.54</span></span>
<span><span class="co">#&gt; 12: aripiprazole            poriomania    16 111531 111547   157   173 17486775      15.97      8.91     26.77      3.36</span></span>
<span><span class="co">#&gt; 13: aripiprazole              overwork     2 111545 111547    70    72 17486862       4.47      0.53     16.79      1.38</span></span>
<span><span class="co">#&gt; 14: aripiprazole   compulsive hoarding   245 111302 111547    75   320 17486857     511.88    396.39    674.49      6.60</span></span>
<span><span class="co">#&gt; 15: aripiprazole   compulsive shopping  1108 110439 111547   782  1890 17486150     224.01    203.60    247.78      6.47</span></span>
<span><span class="co">#&gt; 16: aripiprazole       gaming disorder     3 111544 111547     6     9 17486926      78.38     12.68    365.96      2.65</span></span>
<span><span class="co">#&gt;     IC_lower IC_upper                     label_ROR                label_IC Bonferroni       ROR_signal        IC_signal</span></span>
<span><span class="co">#&gt;        &lt;num&gt;    &lt;num&gt;                        &lt;char&gt;                  &lt;char&gt;     &lt;lgcl&gt;            &lt;ord&gt;            &lt;ord&gt;</span></span>
<span><span class="co">#&gt;  1:     3.05     3.17       9.33 (8.94-9.73) [2324] 3.12 (3.05-3.17) [2324]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  2:     3.64     3.71    14.64 (14.24-15.04) [5898] 3.68 (3.64-3.71) [5898]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  3:     2.94     3.11       8.73 (8.21-9.28) [1114] 3.04 (2.94-3.11) [1114]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  4:     6.18     6.29 153.42 (144.49-162.66) [2479] 6.24 (6.18-6.29) [2479]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  5:     4.27     4.67     28.33 (24.23-32.98) [200]  4.51 (4.27-4.67) [200]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  6:     5.26     5.44     57.56 (53.72-61.6) [1119] 5.36 (5.26-5.44) [1119]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  7:     4.07     4.66       28.25 (22.37-35.3) [92]   4.41 (4.07-4.66) [92]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  8:     5.95     6.36  206.74 (164.42-258.48) [195]  6.18 (5.95-6.36) [195]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt;  9:     2.71     3.45        9.98 (7.56-12.97) [60]   3.14 (2.71-3.45) [60]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt; 10:    -3.26     2.21         1.86 (0.04-10.68) [1]   0.53 (-3.26-2.21) [1]      FALSE not enough cases not enough cases</span></span>
<span><span class="co">#&gt; 11:     1.12     3.45        10.33 (3.69-23.36) [6]    2.54 (1.12-3.45) [6]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt; 12:     2.52     3.95       15.97 (8.91-26.77) [16]   3.36 (2.52-3.95) [16]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt; 13:    -1.21     2.77         4.47 (0.53-16.79) [2]   1.38 (-1.21-2.77) [2]      FALSE not enough cases not enough cases</span></span>
<span><span class="co">#&gt; 14:     6.39     6.75  511.88 (396.39-674.49) [245]   6.6 (6.39-6.75) [245]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt; 15:     6.37     6.54  224.01 (203.6-247.78) [1108] 6.47 (6.37-6.54) [1108]       TRUE              SDR              SDR</span></span>
<span><span class="co">#&gt; 16:     0.58     3.85      78.38 (12.68-365.96) [3]    2.65 (0.58-3.85) [3]       TRUE              SDR              SDR</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/multiple_definitions-1.png" alt="plot of chunk multiple_definitions"><div class="figcaption">plot of chunk multiple_definitions</div>
</div>
<p>The results now show 16 rows (one per drug-event combination), for
which we have found all SDR apart that for excessive exercise and
overwork for which we have found less than 3 cases (the minimum to
identify an SDR with the IC. We can see in the render forests how the
confidence interval is larger for combinations in which there are fewer
cases (compare with the different size of the dots).</p>
</div>
<div class="section level4">
<h4 id="positive-and-negative-controls">Positive and negative controls<a class="anchor" aria-label="anchor" href="#positive-and-negative-controls"></a>
</h4>
<p>The same considerations can in fact be performed also on the drug (we
may want to check the association with aripiprazole alone and with its
pharmacological class as a group (third generation antipsychotics: also
brexpiprazole and cariprazine), and can be used to include also negative
and positive controls: we may include “pramipexole” as a positive
control (a drug which is known to cause impulsivity), “paracetamol” as a
negative control (a drug which is known to not cause impulsivity), and
potentially also some events that are known reactions to aripiprazole
(e.g., insomnia, headache) and some events that are known with good
certainty to not be reactions to aripiprazole (“liver injury”).</p>
<p>In this case we may want to add to the render forest the option to
give each its drug its facet, as seen in the script.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span><span class="va">drug_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"aripiprazole"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"aripiprazole"</span><span class="op">)</span>,</span>
<span>  <span class="st">"TGAs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"aripiprazole"</span>, <span class="st">"brexpiprazole"</span>, <span class="st">"cariprazine"</span><span class="op">)</span>,</span>
<span>  <span class="st">"pramipexole"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pramipexole"</span><span class="op">)</span>, <span class="co"># positive control</span></span>
<span>  <span class="st">"paracetamol"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"paracetamol"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># negative control</span></span>
<span></span>
<span><span class="va">ICDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"gambling disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gambling disorder"</span>, <span class="st">"gambling"</span><span class="op">)</span>,</span>
<span>  <span class="st">"hypersexuality"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"compulsive sexual behaviour"</span>,</span>
<span>    <span class="st">"hypersexuality"</span>,</span>
<span>    <span class="st">"excessive masturbation"</span>,</span>
<span>    <span class="st">"excessive sexual fantasies"</span>,</span>
<span>    <span class="st">"libido increased"</span>,</span>
<span>    <span class="st">"sexual activity increased"</span>,</span>
<span>    <span class="st">"kluver-bucy syndrome"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"paraphilia"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"erotophonophilia"</span>, <span class="st">"exhibitionism"</span>,</span>
<span>    <span class="st">"fetishism"</span>, <span class="st">"frotteurism"</span>,</span>
<span>    <span class="st">"masochism"</span>, <span class="st">"paraphilia"</span>, <span class="st">"paedophilia"</span>,</span>
<span>    <span class="st">"sadism"</span>, <span class="st">"transvestism"</span>, <span class="st">"voyeurism"</span>,</span>
<span>    <span class="st">"sexually inappropriate behaviour"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"compulsive shopping"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"compulsive shopping"</span><span class="op">)</span>,</span>
<span>  <span class="st">"hyperphagia"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"binge eating"</span>, <span class="st">"food craving"</span>, <span class="st">"hyperphagia"</span>,</span>
<span>    <span class="st">"increased appetite"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"gaming disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gaming disorder"</span><span class="op">)</span>,</span>
<span>  <span class="st">"pyromania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pyromania"</span><span class="op">)</span>,</span>
<span>  <span class="st">"kleptomania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"kleptomania"</span>, <span class="st">"shoplifting"</span><span class="op">)</span>,</span>
<span>  <span class="st">"compulsive hoarding"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"compulsive hoarding"</span><span class="op">)</span>,</span>
<span>  <span class="st">"excessive exercise"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"excessive exercise"</span><span class="op">)</span>,</span>
<span>  <span class="st">"overwork"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"overwork"</span><span class="op">)</span>,</span>
<span>  <span class="st">"poriomania"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"poriomania"</span><span class="op">)</span>,</span>
<span>  <span class="st">"body-focused disorder"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"compulsive cheek biting"</span>,</span>
<span>    <span class="st">"compulsive lip biting"</span>,</span>
<span>    <span class="st">"dermatillomania"</span>,</span>
<span>    <span class="st">"dermatophagia"</span>, <span class="st">"nail picking"</span>,</span>
<span>    <span class="st">"compulsive handwashing"</span>,</span>
<span>    <span class="st">"trichotemnomania"</span>,</span>
<span>    <span class="st">"trichotillomania"</span>, <span class="st">"onychophagia"</span>,</span>
<span>    <span class="st">"thumb sucking"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"stereotypy"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"automatism"</span>, <span class="st">"stereotypy"</span><span class="op">)</span>,</span>
<span>  <span class="st">"impulsivity"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"impulse-control disorder"</span>,</span>
<span>    <span class="st">"impulsive behaviour"</span>,</span>
<span>    <span class="st">"disinhibition"</span>, <span class="st">"behavioural addiction"</span>,</span>
<span>    <span class="st">"abnormal behaviour"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="fu">rlist</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlist/man/list.append.html" class="external-link">list.append</a></span><span class="op">(</span><span class="va">ICDs</span>,</span>
<span>  <span class="st">"ICD"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ICDs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"insomnia"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"insomnia"</span><span class="op">)</span>, <span class="co"># positive control</span></span>
<span>  <span class="st">"headache"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"headache"</span><span class="op">)</span>, <span class="co"># positive control</span></span>
<span>  <span class="st">"liver injury"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"liver injury"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># negative control</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="co"># Positive and negative controls</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance                 event   D_E   D_nE      D   nD_E      E    nD_nE ROR_median ROR_lower ROR_upper</span></span>
<span><span class="co">#&gt;           &lt;char&gt;                &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol              headache 42550 886402 928952 495075 537625 16174452       1.56      1.55      1.58</span></span>
<span><span class="co">#&gt;  2:         TGAs              headache  3297 125209 128506 534328 537625 16935645       0.83      0.80      0.86</span></span>
<span><span class="co">#&gt;  3: aripiprazole              headache  2901 108646 111547 534724 537625 16952208       0.84      0.81      0.87</span></span>
<span><span class="co">#&gt;  4:  pramipexole              headache  1218  32344  33562 536407 537625 17028510       1.19      1.12      1.26</span></span>
<span><span class="co">#&gt;  5:  paracetamol              insomnia 18338 910614 928952 213916 232254 16455611       1.54      1.52      1.57</span></span>
<span><span class="co">#&gt;  6:         TGAs              insomnia  4158 124348 128506 228096 232254 17241877       2.52      2.44      2.60</span></span>
<span><span class="co">#&gt;  7: aripiprazole              insomnia  3649 107898 111547 228605 232254 17258327       2.55      2.46      2.63</span></span>
<span><span class="co">#&gt;  8:  pramipexole              insomnia  1368  32194  33562 230886 232254 17334031       3.19      3.01      3.36</span></span>
<span><span class="co">#&gt;  9:  paracetamol           impulsivity  2670 926282 928952  39418  42088 16630109       1.21      1.16      1.26</span></span>
<span><span class="co">#&gt; 10:         TGAs           impulsivity  2463 126043 128506  39625  42088 17430348       8.59      8.24      8.95</span></span>
<span><span class="co">#&gt; 11: aripiprazole           impulsivity  2324 109223 111547  39764  42088 17447168       9.33      8.94      9.73</span></span>
<span><span class="co">#&gt; 12:  pramipexole           impulsivity   846  32716  33562  41242  42088 17523675      10.98     10.24     11.77</span></span>
<span><span class="co">#&gt; 13:  paracetamol                   ICD  4319 924633 928952  67977  72296 16601550       1.14      1.10      1.17</span></span>
<span><span class="co">#&gt; 14:         TGAs                   ICD  6379 122127 128506  65917  72296 17404056      13.79     13.42     14.16</span></span>
<span><span class="co">#&gt; 15: aripiprazole                   ICD  5898 105649 111547  66398  72296 17420534      14.64     14.24     15.04</span></span>
<span><span class="co">#&gt; 16:  pramipexole                   ICD  2669  30893  33562  69627  72296 17495290      21.70     20.84     22.61</span></span>
<span><span class="co">#&gt; 17:  paracetamol           hyperphagia  1170 927782 928952  20104  21274 16649423       1.04      0.98      1.10</span></span>
<span><span class="co">#&gt; 18:         TGAs           hyperphagia  1310 127196 128506  19964  21274 17450009       9.00      8.50      9.52</span></span>
<span><span class="co">#&gt; 19: aripiprazole           hyperphagia  1114 110433 111547  20160  21274 17466772       8.73      8.21      9.28</span></span>
<span><span class="co">#&gt; 20:  pramipexole           hyperphagia   346  33216  33562  20928  21274 17543989       8.73      7.82      9.71</span></span>
<span><span class="co">#&gt; 21:  paracetamol     gambling disorder   311 928641 928952   4757   5068 16664770       1.17      1.04      1.31</span></span>
<span><span class="co">#&gt; 22:         TGAs     gambling disorder  2568 125938 128506   2500   5068 17467473     142.23    135.00    151.42</span></span>
<span><span class="co">#&gt; 23: aripiprazole     gambling disorder  2479 109068 111547   2589   5068 17484343     153.42    144.49    162.66</span></span>
<span><span class="co">#&gt; 24:  pramipexole     gambling disorder  1593  31969  33562   3475   5068 17561442     252.51    237.49    270.92</span></span>
<span><span class="co">#&gt; 25:  paracetamol body-focused disorder    74 928878 928952   1235   1309 16668292       1.07      0.83      1.36</span></span>
<span><span class="co">#&gt; 26:         TGAs body-focused disorder   207 128299 128506   1102   1309 17468871      25.55     21.93     29.71</span></span>
<span><span class="co">#&gt; 27: aripiprazole body-focused disorder   200 111347 111547   1109   1309 17485823      28.33     24.23     32.98</span></span>
<span><span class="co">#&gt; 28:  pramipexole body-focused disorder    16  33546  33562   1293   1309 17563624       6.47      3.69     10.56</span></span>
<span><span class="co">#&gt; 29:  paracetamol        hypersexuality   216 928736 928952   3980   4196 16665547       0.97      0.84      1.11</span></span>
<span><span class="co">#&gt; 30:         TGAs        hypersexuality  1161 127345 128506   3035   4196 17466938      52.53     49.01     56.26</span></span>
<span><span class="co">#&gt; 31: aripiprazole        hypersexuality  1119 110428 111547   3077   4196 17483855      57.56     53.72     61.60</span></span>
<span><span class="co">#&gt; 32:  pramipexole        hypersexuality   584  32978  33562   3612   4196 17561305      86.13     78.75     93.91</span></span>
<span><span class="co">#&gt; 33:  paracetamol            paraphilia    22 928930 928952    581    603 16668946       0.67      0.42      1.03</span></span>
<span><span class="co">#&gt; 34:         TGAs            paraphilia    95 128411 128506    508    603 17469465      25.42     20.20     31.75</span></span>
<span><span class="co">#&gt; 35: aripiprazole            paraphilia    92 111455 111547    511    603 17486421      28.25     22.37     35.30</span></span>
<span><span class="co">#&gt; 36:  pramipexole            paraphilia    62  33500  33562    541    603 17564376      60.09     45.36     78.41</span></span>
<span><span class="co">#&gt; 37:  paracetamol           kleptomania    19 928933 928952    325    344 16669202       1.04      0.62      1.66</span></span>
<span><span class="co">#&gt; 38:         TGAs           kleptomania   197 128309 128506    147    344 17469826     182.18    146.94    229.05</span></span>
<span><span class="co">#&gt; 39: aripiprazole           kleptomania   195 111352 111547    149    344 17486783     206.74    164.42    258.48</span></span>
<span><span class="co">#&gt; 40:  pramipexole           kleptomania    17  33545  33562    327    344 17564590      27.23     15.65     44.28</span></span>
<span><span class="co">#&gt; 41:  paracetamol            stereotypy    28 928924 928952    974   1002 16668553       0.51      0.34      0.75</span></span>
<span><span class="co">#&gt; 42:         TGAs            stereotypy    63 128443 128506    939   1002 17469034       9.12      6.95     11.78</span></span>
<span><span class="co">#&gt; 43: aripiprazole            stereotypy    60 111487 111547    942   1002 17485990       9.98      7.56     12.97</span></span>
<span><span class="co">#&gt; 44:  pramipexole            stereotypy    96  33466  33562    906   1002 17564011      55.63     44.52     68.79</span></span>
<span><span class="co">#&gt; 45:  paracetamol    excessive exercise     5 928947 928952     80     85 16669447       1.12      0.35      2.72</span></span>
<span><span class="co">#&gt; 46:         TGAs    excessive exercise     2 128504 128506     83     85 17469890       3.27      0.39     12.21</span></span>
<span><span class="co">#&gt; 47: aripiprazole    excessive exercise     1 111546 111547     84     85 17486848       1.86      0.04     10.68</span></span>
<span><span class="co">#&gt; 48:  pramipexole    excessive exercise     7  33555  33562     78     85 17564839      46.93     18.28    101.36</span></span>
<span><span class="co">#&gt; 49:  paracetamol             pyromania     1 928951 928952     96     97 16669431       0.18      0.00      1.06</span></span>
<span><span class="co">#&gt; 50:         TGAs             pyromania     6 128500 128506     91     97 17469882       8.96      3.20     20.27</span></span>
<span><span class="co">#&gt; 51: aripiprazole             pyromania     6 111541 111547     91     97 17486841      10.33      3.69     23.36</span></span>
<span><span class="co">#&gt;     IC_median IC_lower IC_upper                     label_ROR                   label_IC Bonferroni       ROR_signal</span></span>
<span><span class="co">#&gt;         &lt;num&gt;    &lt;num&gt;    &lt;num&gt;                        &lt;char&gt;                     &lt;char&gt;     &lt;lgcl&gt;            &lt;ord&gt;</span></span>
<span><span class="co">#&gt;  1:      0.58     0.56     0.59      1.56 (1.55-1.58) [42550]   0.58 (0.56-0.59) [42550]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  2:     -0.26    -0.31    -0.22        0.83 (0.8-0.86) [3297] -0.26 (-0.31--0.22) [3297]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  3:     -0.24    -0.30    -0.19       0.84 (0.81-0.87) [2901]  -0.24 (-0.3--0.19) [2901]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  4:      0.24     0.15     0.31       1.19 (1.12-1.26) [1218]    0.24 (0.15-0.31) [1218]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  5:      0.58     0.55     0.59      1.54 (1.52-1.57) [18338]   0.58 (0.55-0.59) [18338]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  6:      1.29     1.24     1.33        2.52 (2.44-2.6) [4158]    1.29 (1.24-1.33) [4158]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  7:      1.30     1.25     1.34       2.55 (2.46-2.63) [3649]     1.3 (1.25-1.34) [3649]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  8:      1.62     1.53     1.69       3.19 (3.01-3.36) [1368]    1.62 (1.53-1.69) [1368]       TRUE              SDR</span></span>
<span><span class="co">#&gt;  9:      0.26     0.20     0.31       1.21 (1.16-1.26) [2670]     0.26 (0.2-0.31) [2670]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 10:      3.00     2.93     3.04       8.59 (8.24-8.95) [2463]       3 (2.93-3.04) [2463]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 11:      3.12     3.05     3.17       9.33 (8.94-9.73) [2324]    3.12 (3.05-3.17) [2324]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 12:      3.38     3.27     3.47     10.98 (10.24-11.77) [846]     3.38 (3.27-3.47) [846]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 13:      0.17     0.12     0.21        1.14 (1.1-1.17) [4319]    0.17 (0.12-0.21) [4319]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 14:      3.59     3.55     3.62    13.79 (13.42-14.16) [6379]    3.59 (3.55-3.62) [6379]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 15:      3.68     3.64     3.71    14.64 (14.24-15.04) [5898]    3.68 (3.64-3.71) [5898]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 16:      4.26     4.20     4.31     21.7 (20.84-22.61) [2669]     4.26 (4.2-4.31) [2669]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 17:      0.05    -0.04     0.12        1.04 (0.98-1.1) [1170]   0.05 (-0.04-0.12) [1170]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 18:      3.07     2.98     3.13           9 (8.5-9.52) [1310]    3.07 (2.98-3.13) [1310]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 19:      3.04     2.94     3.11       8.73 (8.21-9.28) [1114]    3.04 (2.94-3.11) [1114]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 20:      3.07     2.89     3.20        8.73 (7.82-9.71) [346]      3.07 (2.89-3.2) [346]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 21:      0.21     0.02     0.35        1.17 (1.04-1.31) [311]     0.21 (0.02-0.35) [311]      FALSE              SDR</span></span>
<span><span class="co">#&gt; 22:      6.09     6.03     6.14    142.23 (135-151.42) [2568]    6.09 (6.03-6.14) [2568]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 23:      6.24     6.18     6.29 153.42 (144.49-162.66) [2479]    6.24 (6.18-6.29) [2479]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 24:      7.29     7.20     7.35 252.51 (237.49-270.92) [1593]     7.29 (7.2-7.35) [1593]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 25:      0.09    -0.29     0.37         1.07 (0.83-1.36) [74]     0.09 (-0.29-0.37) [74]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 26:      4.36     4.13     4.53     25.55 (21.93-29.71) [207]     4.36 (4.13-4.53) [207]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 27:      4.51     4.27     4.67     28.33 (24.23-32.98) [200]     4.51 (4.27-4.67) [200]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 28:      2.46     1.61     3.04        6.47 (3.69-10.56) [16]      2.46 (1.61-3.04) [16]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 29:     -0.04    -0.27     0.12        0.97 (0.84-1.11) [216]   -0.04 (-0.27-0.12) [216]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 30:      5.22     5.12     5.29    52.53 (49.01-56.26) [1161]    5.22 (5.12-5.29) [1161]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 31:      5.36     5.26     5.44     57.56 (53.72-61.6) [1119]    5.36 (5.26-5.44) [1119]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 32:      6.10     5.96     6.20     86.13 (78.75-93.91) [584]       6.1 (5.96-6.2) [584]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 33:     -0.53    -1.24    -0.03         0.67 (0.42-1.03) [22]   -0.53 (-1.24--0.03) [22]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 34:      4.28     3.94     4.52       25.42 (20.2-31.75) [95]      4.28 (3.94-4.52) [95]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 35:      4.41     4.07     4.66       28.25 (22.37-35.3) [92]      4.41 (4.07-4.66) [92]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 36:      5.24     4.82     5.54      60.09 (45.36-78.41) [62]      5.24 (4.82-5.54) [62]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 37:      0.06    -0.71     0.60         1.04 (0.62-1.66) [19]      0.06 (-0.71-0.6) [19]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 38:      6.03     5.79     6.20  182.18 (146.94-229.05) [197]      6.03 (5.79-6.2) [197]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 39:      6.18     5.95     6.36  206.74 (164.42-258.48) [195]     6.18 (5.95-6.36) [195]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 40:      3.92     3.10     4.48      27.23 (15.65-44.28) [17]       3.92 (3.1-4.48) [17]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 41:     -0.91    -1.54    -0.46         0.51 (0.34-0.75) [28]   -0.91 (-1.54--0.46) [28]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 42:      3.02     2.60     3.32        9.12 (6.95-11.78) [63]       3.02 (2.6-3.32) [63]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 43:      3.14     2.71     3.45        9.98 (7.56-12.97) [60]      3.14 (2.71-3.45) [60]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 44:      5.32     4.98     5.56      55.63 (44.52-68.79) [96]      5.32 (4.98-5.56) [96]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 45:      0.14    -1.43     1.12          1.12 (0.35-2.72) [5]      0.14 (-1.43-1.12) [5]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 46:      1.15    -1.44     2.54         3.27 (0.39-12.21) [2]      1.15 (-1.44-2.54) [2]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 47:      0.53    -3.26     2.21         1.86 (0.04-10.68) [1]      0.53 (-3.26-2.21) [1]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 48:      3.50     2.19     4.35      46.93 (18.28-101.36) [7]        3.5 (2.19-4.35) [7]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 49:     -1.91    -5.69    -0.22             0.18 (0-1.06) [1]    -1.91 (-5.69--0.22) [1]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 50:      2.42     1.01     3.33          8.96 (3.2-20.27) [6]       2.42 (1.01-3.33) [6]       TRUE              SDR</span></span>
<span><span class="co">#&gt; 51:      2.54     1.12     3.45        10.33 (3.69-23.36) [6]       2.54 (1.12-3.45) [6]       TRUE              SDR</span></span>
<span><span class="co">#&gt;            IC_signal</span></span>
<span><span class="co">#&gt;                &lt;ord&gt;</span></span>
<span><span class="co">#&gt;  1:              SDR</span></span>
<span><span class="co">#&gt;  2:           no SDR</span></span>
<span><span class="co">#&gt;  3:           no SDR</span></span>
<span><span class="co">#&gt;  4:              SDR</span></span>
<span><span class="co">#&gt;  5:              SDR</span></span>
<span><span class="co">#&gt;  6:              SDR</span></span>
<span><span class="co">#&gt;  7:              SDR</span></span>
<span><span class="co">#&gt;  8:              SDR</span></span>
<span><span class="co">#&gt;  9:              SDR</span></span>
<span><span class="co">#&gt; 10:              SDR</span></span>
<span><span class="co">#&gt; 11:              SDR</span></span>
<span><span class="co">#&gt; 12:              SDR</span></span>
<span><span class="co">#&gt; 13:              SDR</span></span>
<span><span class="co">#&gt; 14:              SDR</span></span>
<span><span class="co">#&gt; 15:              SDR</span></span>
<span><span class="co">#&gt; 16:              SDR</span></span>
<span><span class="co">#&gt; 17:           no SDR</span></span>
<span><span class="co">#&gt; 18:              SDR</span></span>
<span><span class="co">#&gt; 19:              SDR</span></span>
<span><span class="co">#&gt; 20:              SDR</span></span>
<span><span class="co">#&gt; 21:              SDR</span></span>
<span><span class="co">#&gt; 22:              SDR</span></span>
<span><span class="co">#&gt; 23:              SDR</span></span>
<span><span class="co">#&gt; 24:              SDR</span></span>
<span><span class="co">#&gt; 25:           no SDR</span></span>
<span><span class="co">#&gt; 26:              SDR</span></span>
<span><span class="co">#&gt; 27:              SDR</span></span>
<span><span class="co">#&gt; 28:              SDR</span></span>
<span><span class="co">#&gt; 29:           no SDR</span></span>
<span><span class="co">#&gt; 30:              SDR</span></span>
<span><span class="co">#&gt; 31:              SDR</span></span>
<span><span class="co">#&gt; 32:              SDR</span></span>
<span><span class="co">#&gt; 33:           no SDR</span></span>
<span><span class="co">#&gt; 34:              SDR</span></span>
<span><span class="co">#&gt; 35:              SDR</span></span>
<span><span class="co">#&gt; 36:              SDR</span></span>
<span><span class="co">#&gt; 37:           no SDR</span></span>
<span><span class="co">#&gt; 38:              SDR</span></span>
<span><span class="co">#&gt; 39:              SDR</span></span>
<span><span class="co">#&gt; 40:              SDR</span></span>
<span><span class="co">#&gt; 41:           no SDR</span></span>
<span><span class="co">#&gt; 42:              SDR</span></span>
<span><span class="co">#&gt; 43:              SDR</span></span>
<span><span class="co">#&gt; 44:              SDR</span></span>
<span><span class="co">#&gt; 45:           no SDR</span></span>
<span><span class="co">#&gt; 46: not enough cases</span></span>
<span><span class="co">#&gt; 47: not enough cases</span></span>
<span><span class="co">#&gt; 48:              SDR</span></span>
<span><span class="co">#&gt; 49: not enough cases</span></span>
<span><span class="co">#&gt; 50:              SDR</span></span>
<span><span class="co">#&gt; 51:              SDR</span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 26 rows ]</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/including_controls-1.png" alt="plot of chunk including_controls"><div class="figcaption">plot of chunk including_controls</div>
</div>
<p>Here we see an extensive association of impulsive manifestations with
aripiprazole, its class (which is in fact almost the same as
aripiprazole as the other two drugs are far less used), and the positive
control pramipexole (which shows also enough cases with excessive
exercise, even if not enough cases with pyromania). Aripiprazole is not
associated with liver injury and headache (as expected), while instead
paracetamol is associated with both, the first a known reaction, the
second a reverse causality (you take paracetamol to treat headache).
Paracetamol is not associated with many of the impulsivity
manifestations, but it is still associated with impulsivity, ICD,
gambling and overwork (you see the red dots that in this plot identify
an SDR). Some possible explanations may be present: overwork and the use
of paracetamol to fight the subsequent migraine have a comprehensible
association, but also impulsivity intended as a more general
irritability due to the pain.</p>
</div>
<div class="section level4">
<h4 id="focusing-on-suspected-drugs">Focusing on suspected drugs<a class="anchor" aria-label="anchor" href="#focusing-on-suspected-drugs"></a>
</h4>
<p>In fact, paracetamol is used so much that it could be in many cases
just recorded as a concomitant. For this reason the next step is
performing the same analysis only considering suspected drugs. We are
not going to change anymore the definition section. Let’s work only on
the disproportionality one, specifying in the temp_drug (the drug
database we want to use, which is the entire drug by default) only drugs
which are recorded as primary or secondary suspect (rol_cod %in%
c(“PS”,“SS”)). Remember to respond “no” in the console when the function
asks you if you want to refine the query.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="co"># Suspected drugs</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="va">reac_selected</span>,</span>
<span>  temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance                 event   D_E   D_nE      D   nD_E      E    nD_nE ROR_median ROR_lower ROR_upper</span></span>
<span><span class="co">#&gt;           &lt;char&gt;                &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol              headache  8275 334670 342945 529350 537625 16725628       0.78      0.76      0.79</span></span>
<span><span class="co">#&gt;  2: aripiprazole              headache  1697  79728  81425 535928 537625 16980570       0.67      0.64      0.70</span></span>
<span><span class="co">#&gt;  3:         TGAs              headache  1970  94009  95979 535655 537625 16966289       0.66      0.63      0.69</span></span>
<span><span class="co">#&gt;  4:  pramipexole              headache   269  10828  11097 537356 537625 17049470       0.78      0.69      0.88</span></span>
<span><span class="co">#&gt;  5:  paracetamol              insomnia  4630 338315 342945 227624 232254 17027354       1.02      0.99      1.05</span></span>
<span><span class="co">#&gt;  6: aripiprazole              insomnia  2749  78676  81425 229505 232254 17286993       2.63      2.53      2.73</span></span>
<span><span class="co">#&gt;  7:         TGAs              insomnia  3192  92787  95979 229062 232254 17272882       2.59      2.50      2.68</span></span>
<span><span class="co">#&gt;  8:  pramipexole              insomnia   554  10543  11097 231700 232254 17355126       3.93      3.60      4.28</span></span>
<span><span class="co">#&gt;  9:  paracetamol           impulsivity   791 342154 342945  41297  42088 17213681       0.96      0.89      1.03</span></span>
<span><span class="co">#&gt; 10: aripiprazole           impulsivity  1901  79524  81425  40187  42088 17476311      10.39      9.91     10.89</span></span>
<span><span class="co">#&gt; 11:         TGAs           impulsivity  2029  93950  95979  40059  42088 17461885       9.41      8.99      9.84</span></span>
<span><span class="co">#&gt; 12:  pramipexole           impulsivity   667  10430  11097  41421  42088 17545405      27.09     25.00     29.32</span></span>
<span><span class="co">#&gt; 13:  paracetamol                   ICD   962 341983 342945  71334  72296 17183644       0.67      0.63      0.72</span></span>
<span><span class="co">#&gt; 14: aripiprazole                   ICD  5208  76217  81425  67088  72296 17449410      17.77     17.25     18.30</span></span>
<span><span class="co">#&gt; 15:         TGAs                   ICD  5666  90313  95979  66630  72296 17435314      16.41     15.96     16.89</span></span>
<span><span class="co">#&gt; 16:  pramipexole                   ICD  2376   8721  11097  69920  72296 17516906      68.26     65.14     71.25</span></span>
<span><span class="co">#&gt; 17:  paracetamol           hyperphagia   108 342837 342945  21166  21274 17233812       0.25      0.21      0.30</span></span>
<span><span class="co">#&gt; 18: aripiprazole           hyperphagia   935  80490  81425  20339  21274 17496159       9.99      9.34     10.67</span></span>
<span><span class="co">#&gt; 19:         TGAs           hyperphagia  1124  94855  95979  20150  21274 17481794      10.27      9.67     10.92</span></span>
<span><span class="co">#&gt; 20:  pramipexole           hyperphagia   293  10804  11097  20981  21274 17565845      22.70     20.12     25.51</span></span>
<span><span class="co">#&gt; 21:  paracetamol     gambling disorder     9 342936 342945   5059   5068 17249919       0.08      0.04      0.17</span></span>
<span><span class="co">#&gt; 22: aripiprazole     gambling disorder  2470  78955  81425   2598   5068 17513900     210.01    199.18    223.51</span></span>
<span><span class="co">#&gt; 23:         TGAs     gambling disorder  2559  93420  95979   2509   5068 17499435     192.03    180.40    202.70</span></span>
<span><span class="co">#&gt; 24:  pramipexole     gambling disorder  1543   9554  11097   3525   5068 17583301     803.07    748.12    869.09</span></span>
<span><span class="co">#&gt; 25:  paracetamol body-focused disorder    18 342927 342945   1291   1309 17253687       0.70      0.41      1.11</span></span>
<span><span class="co">#&gt; 26: aripiprazole body-focused disorder   190  81235  81425   1119   1309 17515379      36.60     31.21     42.79</span></span>
<span><span class="co">#&gt; 27:         TGAs body-focused disorder   194  95785  95979   1115   1309 17500829      31.79     27.12     37.07</span></span>
<span><span class="co">#&gt; 28:  pramipexole body-focused disorder    13  11084  11097   1296   1309 17585530      15.91      8.44     27.32</span></span>
<span><span class="co">#&gt; 29:  paracetamol        hypersexuality    10 342935 342945   4186   4196 17250792       0.12      0.05      0.22</span></span>
<span><span class="co">#&gt; 30: aripiprazole        hypersexuality  1050  80375  81425   3146   4196 17513352      72.72     67.81     78.04</span></span>
<span><span class="co">#&gt; 31:         TGAs        hypersexuality  1092  94887  95979   3104   4196 17498840      64.89     60.39     69.69</span></span>
<span><span class="co">#&gt; 32:  pramipexole        hypersexuality   544  10553  11097   3652   4196 17583174     249.04    224.63    270.52</span></span>
<span><span class="co">#&gt; 33:  paracetamol            paraphilia     7 342938 342945    596    603 17254382       0.59      0.23      1.22</span></span>
<span><span class="co">#&gt; 34: aripiprazole            paraphilia    83  81342  81425    520    603 17515978      34.37     26.92     43.39</span></span>
<span><span class="co">#&gt; 35:         TGAs            paraphilia    85  95894  95979    518    603 17501426      29.95     23.51     37.70</span></span>
<span><span class="co">#&gt; 36:  pramipexole            paraphilia    61  11036  11097    542    603 17586284     180.22    135.62    232.69</span></span>
<span><span class="co">#&gt; 37:  paracetamol           kleptomania     3 342942 342945    341    344 17254637       0.44      0.09      1.30</span></span>
<span><span class="co">#&gt; 38: aripiprazole           kleptomania   193  81232  81425    151    344 17516347     274.75    220.79    349.42</span></span>
<span><span class="co">#&gt; 39:         TGAs           kleptomania   195  95784  95979    149    344 17501795     240.10    192.47    297.18</span></span>
<span><span class="co">#&gt; 40:  pramipexole           kleptomania    13  11084  11097    331    344 17586495      62.35     32.82    108.31</span></span>
<span><span class="co">#&gt; 41:  paracetamol            stereotypy    11 342934 342945    991   1002 17253987       0.55      0.27      1.00</span></span>
<span><span class="co">#&gt; 42: aripiprazole            stereotypy    55  81370  81425    947   1002 17515551      12.50      9.34     16.41</span></span>
<span><span class="co">#&gt; 43:         TGAs            stereotypy    58  95921  95979    944   1002 17501000      11.21      8.44     14.62</span></span>
<span><span class="co">#&gt; 44:  pramipexole            stereotypy    87  11010  11097    915   1002 17585911     152.33    120.89    188.92</span></span>
<span><span class="co">#&gt; 45:  paracetamol    excessive exercise     1 342944 342945     84     85 17254894       0.59      0.01      3.42</span></span>
<span><span class="co">#&gt; 46: aripiprazole    excessive exercise     1  81424  81425     84     85 17516414       2.56      0.06     14.66</span></span>
<span><span class="co">#&gt; 47:         TGAs    excessive exercise     2  95977  95979     83     85 17501861       4.39      0.52     16.37</span></span>
<span><span class="co">#&gt; 48:  pramipexole    excessive exercise     7  11090  11097     78     85 17586748     142.26     55.35    306.66</span></span>
<span><span class="co">#&gt; 49:  paracetamol             pyromania     1 342944 342945     96     97 17254882       0.52      0.01      2.99</span></span>
<span><span class="co">#&gt; 50: aripiprazole             pyromania     6  81419  81425     91     97 17516407      14.18      5.07     32.10</span></span>
<span><span class="co">#&gt; 51:         TGAs             pyromania     6  95973  95979     91     97 17501853      12.02      4.29     27.19</span></span>
<span><span class="co">#&gt;     IC_median IC_lower IC_upper                     label_ROR                   label_IC Bonferroni       ROR_signal</span></span>
<span><span class="co">#&gt;         &lt;num&gt;    &lt;num&gt;    &lt;num&gt;                        &lt;char&gt;                     &lt;char&gt;     &lt;lgcl&gt;            &lt;ord&gt;</span></span>
<span><span class="co">#&gt;  1:     -0.35    -0.38    -0.32       0.78 (0.76-0.79) [8275] -0.35 (-0.38--0.32) [8275]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  2:     -0.56    -0.64    -0.50        0.67 (0.64-0.7) [1697]  -0.56 (-0.64--0.5) [1697]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  3:     -0.58    -0.65    -0.52       0.66 (0.63-0.69) [1970] -0.58 (-0.65--0.52) [1970]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  4:     -0.34    -0.54    -0.19        0.78 (0.69-0.88) [269]  -0.34 (-0.54--0.19) [269]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  5:      0.03    -0.02     0.06       1.02 (0.99-1.05) [4630]   0.03 (-0.02-0.06) [4630]      FALSE           no SDR</span></span>
<span><span class="co">#&gt;  6:      1.35     1.29     1.40       2.63 (2.53-2.73) [2749]     1.35 (1.29-1.4) [2749]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt;  7:      1.33     1.27     1.37        2.59 (2.5-2.68) [3192]    1.33 (1.27-1.37) [3192]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt;  8:      1.91     1.77     2.01         3.93 (3.6-4.28) [554]     1.91 (1.77-2.01) [554]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt;  9:     -0.06    -0.17     0.03        0.96 (0.89-1.03) [791]   -0.06 (-0.17-0.03) [791]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 10:      3.28     3.20     3.33     10.39 (9.91-10.89) [1901]     3.28 (3.2-3.33) [1901]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 11:      3.14     3.06     3.19       9.41 (8.99-9.84) [2029]    3.14 (3.06-3.19) [2029]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 12:      4.62     4.49     4.71        27.09 (25-29.32) [667]     4.62 (4.49-4.71) [667]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 13:     -0.56    -0.66    -0.48        0.67 (0.63-0.72) [962]  -0.56 (-0.66--0.48) [962]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 14:      3.95     3.91     3.99     17.77 (17.25-18.3) [5208]    3.95 (3.91-3.99) [5208]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 15:      3.84     3.79     3.87    16.41 (15.96-16.89) [5666]    3.84 (3.79-3.87) [5666]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 16:      5.68     5.62     5.73    68.26 (65.14-71.25) [2376]    5.68 (5.62-5.73) [2376]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 17:     -1.94    -2.26    -1.71         0.25 (0.21-0.3) [108]  -1.94 (-2.26--1.71) [108]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 18:      3.24     3.13     3.31       9.99 (9.34-10.67) [935]     3.24 (3.13-3.31) [935]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 19:      3.27     3.17     3.34     10.27 (9.67-10.92) [1124]    3.27 (3.17-3.34) [1124]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 20:      4.39     4.20     4.53      22.7 (20.12-25.51) [293]      4.39 (4.2-4.53) [293]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 21:     -3.39    -4.53    -2.63          0.08 (0.04-0.17) [9]    -3.39 (-4.53--2.63) [9]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 22:      6.68     6.62     6.73 210.01 (199.18-223.51) [2470]    6.68 (6.62-6.73) [2470]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 23:      6.50     6.44     6.55   192.03 (180.4-202.7) [2559]     6.5 (6.44-6.55) [2559]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 24:      8.70     8.62     8.76 803.07 (748.12-869.09) [1543]     8.7 (8.62-8.76) [1543]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 25:     -0.50    -1.29     0.06          0.7 (0.41-1.11) [18]     -0.5 (-1.29-0.06) [18]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 26:      4.86     4.62     5.03      36.6 (31.21-42.79) [190]     4.86 (4.62-5.03) [190]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 27:      4.67     4.43     4.84     31.79 (27.12-37.07) [194]     4.67 (4.43-4.84) [194]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 28:      3.34     2.40     3.99       15.91 (8.44-27.32) [13]       3.34 (2.4-3.99) [13]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 29:     -2.97    -4.05    -2.25         0.12 (0.05-0.22) [10]   -2.97 (-4.05--2.25) [10]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 30:      5.72     5.61     5.79    72.72 (67.81-78.04) [1050]    5.72 (5.61-5.79) [1050]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 31:      5.54     5.44     5.61    64.89 (60.39-69.69) [1092]    5.54 (5.44-5.61) [1092]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 32:      7.43     7.29     7.53  249.04 (224.63-270.52) [544]     7.43 (7.29-7.53) [544]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 33:     -0.71    -2.02     0.14          0.59 (0.23-1.22) [7]     -0.71 (-2.02-0.14) [7]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 34:      4.66     4.30     4.92      34.37 (26.92-43.39) [83]       4.66 (4.3-4.92) [83]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 35:      4.49     4.13     4.75       29.95 (23.51-37.7) [85]      4.49 (4.13-4.75) [85]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 36:      6.12     5.70     6.43   180.22 (135.62-232.69) [61]       6.12 (5.7-6.43) [61]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 37:     -1.05    -3.12     0.16           0.44 (0.09-1.3) [3]     -1.05 (-3.12-0.16) [3]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 38:      6.53     6.29     6.70  274.75 (220.79-349.42) [193]      6.53 (6.29-6.7) [193]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 39:      6.36     6.12     6.53   240.1 (192.47-297.18) [195]     6.36 (6.12-6.53) [195]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 40:      4.23     3.29     4.87     62.35 (32.82-108.31) [13]      4.23 (3.29-4.87) [13]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 41:     -0.81    -1.83    -0.11            0.55 (0.27-1) [11]   -0.81 (-1.83--0.11) [11]      FALSE           no SDR</span></span>
<span><span class="co">#&gt; 42:      3.43     2.98     3.75        12.5 (9.34-16.41) [55]      3.43 (2.98-3.75) [55]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 43:      3.29     2.85     3.60       11.21 (8.44-14.62) [58]       3.29 (2.85-3.6) [58]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 44:      6.27     5.91     6.52   152.33 (120.89-188.92) [87]      6.27 (5.91-6.52) [87]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 45:     -0.53    -4.31     1.16          0.59 (0.01-3.42) [1]     -0.53 (-4.31-1.16) [1]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 46:      0.74    -3.04     2.43         2.56 (0.06-14.66) [1]      0.74 (-3.04-2.43) [1]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 47:      1.37    -1.22     2.76         4.39 (0.52-16.37) [2]      1.37 (-1.22-2.76) [2]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 48:      3.75     2.45     4.61     142.26 (55.35-306.66) [7]       3.75 (2.45-4.61) [7]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 49:     -0.68    -4.46     1.01          0.52 (0.01-2.99) [1]     -0.68 (-4.46-1.01) [1]      FALSE not enough cases</span></span>
<span><span class="co">#&gt; 50:      2.77     1.36     3.68         14.18 (5.07-32.1) [6]       2.77 (1.36-3.68) [6]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt; 51:      2.65     1.24     3.57        12.02 (4.29-27.19) [6]       2.65 (1.24-3.57) [6]       TRUE         weak SDR</span></span>
<span><span class="co">#&gt;            IC_signal</span></span>
<span><span class="co">#&gt;                &lt;ord&gt;</span></span>
<span><span class="co">#&gt;  1:           no SDR</span></span>
<span><span class="co">#&gt;  2:           no SDR</span></span>
<span><span class="co">#&gt;  3:           no SDR</span></span>
<span><span class="co">#&gt;  4:           no SDR</span></span>
<span><span class="co">#&gt;  5:           no SDR</span></span>
<span><span class="co">#&gt;  6:              SDR</span></span>
<span><span class="co">#&gt;  7:              SDR</span></span>
<span><span class="co">#&gt;  8:              SDR</span></span>
<span><span class="co">#&gt;  9:           no SDR</span></span>
<span><span class="co">#&gt; 10:              SDR</span></span>
<span><span class="co">#&gt; 11:              SDR</span></span>
<span><span class="co">#&gt; 12:              SDR</span></span>
<span><span class="co">#&gt; 13:           no SDR</span></span>
<span><span class="co">#&gt; 14:              SDR</span></span>
<span><span class="co">#&gt; 15:              SDR</span></span>
<span><span class="co">#&gt; 16:              SDR</span></span>
<span><span class="co">#&gt; 17:           no SDR</span></span>
<span><span class="co">#&gt; 18:              SDR</span></span>
<span><span class="co">#&gt; 19:              SDR</span></span>
<span><span class="co">#&gt; 20:              SDR</span></span>
<span><span class="co">#&gt; 21:           no SDR</span></span>
<span><span class="co">#&gt; 22:              SDR</span></span>
<span><span class="co">#&gt; 23:              SDR</span></span>
<span><span class="co">#&gt; 24:              SDR</span></span>
<span><span class="co">#&gt; 25:           no SDR</span></span>
<span><span class="co">#&gt; 26:              SDR</span></span>
<span><span class="co">#&gt; 27:              SDR</span></span>
<span><span class="co">#&gt; 28:              SDR</span></span>
<span><span class="co">#&gt; 29:           no SDR</span></span>
<span><span class="co">#&gt; 30:              SDR</span></span>
<span><span class="co">#&gt; 31:              SDR</span></span>
<span><span class="co">#&gt; 32:              SDR</span></span>
<span><span class="co">#&gt; 33:           no SDR</span></span>
<span><span class="co">#&gt; 34:              SDR</span></span>
<span><span class="co">#&gt; 35:              SDR</span></span>
<span><span class="co">#&gt; 36:              SDR</span></span>
<span><span class="co">#&gt; 37:           no SDR</span></span>
<span><span class="co">#&gt; 38:              SDR</span></span>
<span><span class="co">#&gt; 39:              SDR</span></span>
<span><span class="co">#&gt; 40:              SDR</span></span>
<span><span class="co">#&gt; 41:           no SDR</span></span>
<span><span class="co">#&gt; 42:              SDR</span></span>
<span><span class="co">#&gt; 43:              SDR</span></span>
<span><span class="co">#&gt; 44:              SDR</span></span>
<span><span class="co">#&gt; 45: not enough cases</span></span>
<span><span class="co">#&gt; 46: not enough cases</span></span>
<span><span class="co">#&gt; 47: not enough cases</span></span>
<span><span class="co">#&gt; 48:              SDR</span></span>
<span><span class="co">#&gt; 49: not enough cases</span></span>
<span><span class="co">#&gt; 50:              SDR</span></span>
<span><span class="co">#&gt; 51:              SDR</span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 26 rows ]</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/only_suspect-1.png" alt="plot of chunk only_suspect"><div class="figcaption">plot of chunk only_suspect</div>
</div>
<p>You see this way how all the associations between impulsivity and
paracetamol disappear, including, interestingly, also the one with
headache (but not the one with overwork).</p>
</div>
<div class="section level4">
<h4 id="removing-duplicates">Removing duplicates<a class="anchor" aria-label="anchor" href="#removing-duplicates"></a>
</h4>
<p>Duplicates may also distort our results. The problem is that we are
not sure which reports are duplicates and which are not. Applying a
deduplication algorithm may therefore introduce even more distortion.
The DiAna package already comes with multiple rule-based strategies to
detect potential duplicates, and will soon add even more advanced
probabilistic algorithms. The results of these duplicates detection is
stored in the DEMO dataset. We therefore have to first import it, going
back into the dedicated section and adding the following row together
with the other two importing Drug and Reac:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import data ----------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"DEMO"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid    sex age_in_days wt_in_kgs occr_country event_dt occp_cod          reporter_country rept_cod</span></span>
<span><span class="co">#&gt;               &lt;num&gt; &lt;fctr&gt;       &lt;num&gt;     &lt;num&gt;       &lt;fctr&gt;    &lt;int&gt;   &lt;fctr&gt;                    &lt;fctr&gt;   &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;        1:  45217461      M        9855        NA         &lt;NA&gt; 19861106       MD  United States of America      DIR</span></span>
<span><span class="co">#&gt;        2:  57910401   &lt;NA&gt;          NA        NA         &lt;NA&gt;       NA     &lt;NA&gt;  United States of America      DIR</span></span>
<span><span class="co">#&gt;        3:  56962401   &lt;NA&gt;          NA        NA         &lt;NA&gt; 19960123     &lt;NA&gt;  United States of America      DIR</span></span>
<span><span class="co">#&gt;        4:  54662121      F       22630        NA         &lt;NA&gt; 19960919       CN South Africa, Republic of      EXP</span></span>
<span><span class="co">#&gt;        5:  31231172      F       21535        68         &lt;NA&gt; 19970927       MD  United States of America      EXP</span></span>
<span><span class="co">#&gt;       ---                                                                                                         </span></span>
<span><span class="co">#&gt; 17598475: 236937711      F        9490        68         &lt;NA&gt; 20240318       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598476: 236937721      M        6205        NA         &lt;NA&gt; 20240101       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598477: 236937741      F       13140       134         &lt;NA&gt; 20240322       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598478: 237079261      F       15695        90         &lt;NA&gt;       NA       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt; 17598479: 237079291      M       22265       108         &lt;NA&gt; 20240228       CN  United States of America      DIR</span></span>
<span><span class="co">#&gt;           init_fda_dt   fda_dt premarketing literature RB_duplicates RB_duplicates_only_susp</span></span>
<span><span class="co">#&gt;                 &lt;int&gt;    &lt;int&gt;       &lt;lgcl&gt;     &lt;lgcl&gt;        &lt;lgcl&gt;                  &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt;        1:    19861224 19861224        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        2:    19920917 19920917        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        3:    19960126 19960126        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        4:    19961022 19961022        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;        5:    19971203 19971212        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt;       ---                                                                                   </span></span>
<span><span class="co">#&gt; 17598475:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598476:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598477:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598478:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span>
<span><span class="co">#&gt; 17598479:    20240331 20240331        FALSE      FALSE         FALSE                   FALSE</span></span></code></pre></div>
<p>In the printed dataset we see that the last two columns are
RB_duplicates and RB_duplicates_only_susp: the first is more
conservative, considering as duplicates all the reports that have not
only the same sex, age, country, event list, event date, and suspected
drug list, but also the concomitants. The second algorithm considers
instead only suspected drugs in the drug list.</p>
<p>Let’s reduce the queries considered among the reactions to visualize
better the differences in the disproportionality results obtained with
the two different algorithms compared to the raw analysis. You can
comment the previous generation to reac_selected with a # if you want to
keep it and then go back to the previous definition later.</p>
<p>In the disproportionality_analysis section we know include a loop
over several possible restrictions of the background reference group:
our raw and deduplicated datasets using the different algorithms (raw is
the entire dataset, RB1 is the more conservative and RB2 the more
speculative deduplication). You will have to answer no in the console
every time you are asked (three times).</p>
<p>The disproportionality_df has now a row for each
drug-event-background combination, and the background is specified in
the “nested” column, which we specified as the “nested” parameter of the
render_forest.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Definitions --------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># .....all the content before....</span></span>
<span></span>
<span><span class="co"># reac_selected &lt;- rlist::list.append(ICDs,"ICD"=as.list(unlist(purrr::flatten(ICDs))))</span></span>
<span><span class="va">reac_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ICD"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ICDs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="co"># Deduplication</span></span>
<span><span class="va">restrictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"raw"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span>,</span>
<span>  <span class="st">"RB1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">[</span><span class="va">RB_duplicates</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span>,</span>
<span>  <span class="st">"RB2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">[</span><span class="va">RB_duplicates_only_susp</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">restrictions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">restrictions</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span>  <span class="va">t_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">t_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>    drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>    reac_selected <span class="op">=</span> <span class="va">reac_selected</span>,</span>
<span>    temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    restriction <span class="op">=</span> <span class="va">t_pids</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="va">nested</span> <span class="op">:=</span> <span class="va">t_name</span><span class="op">]</span></span>
<span>  <span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, <span class="va">df</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;           &lt;char&gt; &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol    ICD   962 341983 342945 71334 72296 17183644       0.67      0.63      0.72     -0.56    -0.66</span></span>
<span><span class="co">#&gt;  2: aripiprazole    ICD  5208  76217  81425 67088 72296 17449410      17.77     17.25     18.30      3.95     3.91</span></span>
<span><span class="co">#&gt;  3:         TGAs    ICD  5666  90313  95979 66630 72296 17435314      16.41     15.96     16.89      3.84     3.79</span></span>
<span><span class="co">#&gt;  4:  pramipexole    ICD  2376   8721  11097 69920 72296 17516906      68.26     65.14     71.25      5.68     5.62</span></span>
<span><span class="co">#&gt;  5:  paracetamol    ICD   930 225399 226329 67187 68117 14166693       0.86      0.81      0.92     -0.20    -0.31</span></span>
<span><span class="co">#&gt;  6: aripiprazole    ICD  4684  61702  66386 63433 68117 14330390      17.16     16.62     17.69      3.90     3.85</span></span>
<span><span class="co">#&gt;  7:         TGAs    ICD  5127  73112  78239 62990 68117 14318980      15.94     15.48     16.41      3.79     3.75</span></span>
<span><span class="co">#&gt;  8:  pramipexole    ICD  2091   7702   9793 66026 68117 14384390      59.11     56.24     62.03      5.48     5.41</span></span>
<span><span class="co">#&gt;  9:  paracetamol    ICD   909 210723 211632 66283 67192 13701560       0.89      0.83      0.95     -0.17    -0.28</span></span>
<span><span class="co">#&gt; 10: aripiprazole    ICD  4530  57485  62015 62662 67192 13854798      17.42     16.87     17.98      3.92     3.87</span></span>
<span><span class="co">#&gt; 11:         TGAs    ICD  4958  68306  73264 62234 67192 13843977      16.14     15.67     16.63      3.81     3.76</span></span>
<span><span class="co">#&gt; 12:  pramipexole    ICD  2050   7260   9310 65142 67192 13905023      60.29     57.27     63.24      5.50     5.42</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal nested</span></span>
<span><span class="co">#&gt;        &lt;num&gt;                     &lt;char&gt;                    &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:    -0.48     0.67 (0.63-0.72) [962] -0.56 (-0.66--0.48) [962]      FALSE     no SDR    no SDR    raw</span></span>
<span><span class="co">#&gt;  2:     3.99  17.77 (17.25-18.3) [5208]   3.95 (3.91-3.99) [5208]       TRUE   weak SDR       SDR    raw</span></span>
<span><span class="co">#&gt;  3:     3.87 16.41 (15.96-16.89) [5666]   3.84 (3.79-3.87) [5666]       TRUE   weak SDR       SDR    raw</span></span>
<span><span class="co">#&gt;  4:     5.73 68.26 (65.14-71.25) [2376]   5.68 (5.62-5.73) [2376]       TRUE   weak SDR       SDR    raw</span></span>
<span><span class="co">#&gt;  5:    -0.12     0.86 (0.81-0.92) [930]  -0.2 (-0.31--0.12) [930]      FALSE     no SDR    no SDR    RB1</span></span>
<span><span class="co">#&gt;  6:     3.93 17.16 (16.62-17.69) [4684]    3.9 (3.85-3.93) [4684]       TRUE   weak SDR       SDR    RB1</span></span>
<span><span class="co">#&gt;  7:     3.82 15.94 (15.48-16.41) [5127]   3.79 (3.75-3.82) [5127]       TRUE   weak SDR       SDR    RB1</span></span>
<span><span class="co">#&gt;  8:     5.53 59.11 (56.24-62.03) [2091]   5.48 (5.41-5.53) [2091]       TRUE   weak SDR       SDR    RB1</span></span>
<span><span class="co">#&gt;  9:    -0.09     0.89 (0.83-0.95) [909] -0.17 (-0.28--0.09) [909]      FALSE     no SDR    no SDR    RB2</span></span>
<span><span class="co">#&gt; 10:     3.95 17.42 (16.87-17.98) [4530]   3.92 (3.87-3.95) [4530]       TRUE   weak SDR       SDR    RB2</span></span>
<span><span class="co">#&gt; 11:     3.84 16.14 (15.67-16.63) [4958]   3.81 (3.76-3.84) [4958]       TRUE   weak SDR       SDR    RB2</span></span>
<span><span class="co">#&gt; 12:     5.55 60.29 (57.27-63.24) [2050]    5.5 (5.42-5.55) [2050]       TRUE   weak SDR       SDR    RB2</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span>, nested <span class="op">=</span> <span class="st">"nested"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/deduplication_algorithms-1.png" alt="plot of chunk deduplication_algorithms"><div class="figcaption">plot of chunk deduplication_algorithms</div>
</div>
<p>The forest plot shows in fact almost no difference when using the raw
analysis compared to the two different rule-based deduplication
algorithms available in DiAna for the investigated drug-event
combination, resulting in a significant difference only for paracetamol
(a signal for impulsivity appears when deduplicating, independently of
the algorithm). For most drug-event combinations, we expect to find
small differences when deduplicating, but it is always recommended to
provide both raw and deduplicated analyses.</p>
</div>
<div class="section level4">
<h4 id="restricting-on-indication">Restricting on indication<a class="anchor" aria-label="anchor" href="#restricting-on-indication"></a>
</h4>
<p>Another important application made possible by the
disproportionality_analysis function is related with addressing expected
biases. When investigating a potential causal role of aripiprazole in
inducing impulsivity, we should consider that bipolar disorder, a major
indication for using aripiprazole, is also a known risk factor for
impulsivity and impulsive behaviors.</p>
<p>Could that be sufficient to explain the association (SDR) we found?
To address, at least partly, this indication bias and answer this
question we can restrict the analysis to patients sharing a diagnosis of
bipolar disorder, and checking in this population with homogeneous
values for the confounder whether impulsivity is more often recorded
together with aripiprazole than with other drugs. For a pedagogical
article on how to chose the background reference group (and why
restricting on the confounder should be preferred to adjusting on it)
see <a href="https://doi.org/10.31219/osf.io/h5w9u" class="external-link uri">https://doi.org/10.31219/osf.io/h5w9u</a>. We check for the
presence of the confounder among the indications, and we therefore have
to import the Indi database adding it to the import data section.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import data ----------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"INDI"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid   drug_seq                                 indi_pt</span></span>
<span><span class="co">#&gt;               &lt;num&gt;      &lt;int&gt;                                   &lt;ord&gt;</span></span>
<span><span class="co">#&gt;        1:   4204616 1004278786                        abortion induced</span></span>
<span><span class="co">#&gt;        2:   4223542 1004334703                         crohn's disease</span></span>
<span><span class="co">#&gt;        3:   4250482 1004434717                         crohn's disease</span></span>
<span><span class="co">#&gt;        4:   4261823 1004486217                     bronchial carcinoma</span></span>
<span><span class="co">#&gt;        5:   4261823 1004486218                     bronchial carcinoma</span></span>
<span><span class="co">#&gt;       ---                                                             </span></span>
<span><span class="co">#&gt; 41380269: 992001227        583     product used for unknown indication</span></span>
<span><span class="co">#&gt; 41380270: 992001227        586     product used for unknown indication</span></span>
<span><span class="co">#&gt; 41380271: 236936391          1 beta haemolytic streptococcal infection</span></span>
<span><span class="co">#&gt; 41380272: 237079291          1                    acrochordon excision</span></span>
<span><span class="co">#&gt; 41380273: 237203351          1     product used for unknown indication</span></span></code></pre></div>
<p>We can then search in the Indi dataset for the recording of bipolar
disorder, and select their primaryids. To be more exhaustive in the
identification of reports concerning patients diagnosed with bipolar
disorder, thus collecting greater number of reports for the analysis, we
search for bipolar disorder also in the Reac database (confusion may
have arisen in the compilation), and for lithium (a specific tratment
for bipolar disorder) among the drugs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reference groups --------------------------------------------------------------------</span></span>
<span><span class="va">bipolar_disorder_indi_pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Indi</span><span class="op">[</span><span class="va">indi_pt</span> <span class="op">==</span> <span class="st">"bipolar disorder"</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span></span>
<span><span class="va">bipolar_disorder_reac_pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Reac</span><span class="op">[</span><span class="va">pt</span> <span class="op">==</span> <span class="st">"bipolar disorder"</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span></span>
<span><span class="va">bipolar_disorder_drug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Drug</span><span class="op">[</span><span class="va">substance</span> <span class="op">==</span> <span class="st">"lithium"</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span></span>
<span><span class="va">bipolar_disorder_total_pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">bipolar_disorder_indi_pt</span>, <span class="va">bipolar_disorder_reac_pt</span><span class="op">)</span>, <span class="va">bipolar_disorder_drug</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span></span>
<span><span class="va">restrictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"raw"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span>,</span>
<span>  <span class="st">"indi_pt"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_indi_pt</span><span class="op">)</span>,</span>
<span>  <span class="st">"reac_pt"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_reac_pt</span><span class="op">)</span>,</span>
<span>  <span class="st">"drug"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_drug</span><span class="op">)</span>,</span>
<span>  <span class="st">"total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_total_pt</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">restrictions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">restrictions</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span>  <span class="va">t_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">t_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>    drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>    reac_selected <span class="op">=</span> <span class="va">reac_selected</span>,</span>
<span>    temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    restriction <span class="op">=</span> <span class="va">t_pids</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="va">nested</span> <span class="op">:=</span> <span class="va">t_name</span><span class="op">]</span></span>
<span>  <span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, <span class="va">df</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;           &lt;char&gt; &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol    ICD   962 341983 342945 71334 72296 17183644       0.67      0.63      0.72     -0.56    -0.66</span></span>
<span><span class="co">#&gt;  2: aripiprazole    ICD  5208  76217  81425 67088 72296 17449410      17.77     17.25     18.30      3.95     3.91</span></span>
<span><span class="co">#&gt;  3:         TGAs    ICD  5666  90313  95979 66630 72296 17435314      16.41     15.96     16.89      3.84     3.79</span></span>
<span><span class="co">#&gt;  4:  pramipexole    ICD  2376   8721  11097 69920 72296 17516906      68.26     65.14     71.25      5.68     5.62</span></span>
<span><span class="co">#&gt;  5:  paracetamol    ICD    17    473    490  2890  2907    72658       0.90      0.52      1.46     -0.14    -0.96</span></span>
<span><span class="co">#&gt;  6: aripiprazole    ICD  1310   8131   9441  1597  2907    65000       6.55      6.06      7.08      1.85     1.76</span></span>
<span><span class="co">#&gt;  7:         TGAs    ICD  1371   9580  10951  1536  2907    63551       5.92      5.48      6.39      1.71     1.62</span></span>
<span><span class="co">#&gt;  8:  pramipexole    ICD     7     49     56  2900  2907    73082       3.59      1.37      7.99      1.50     0.20</span></span>
<span><span class="co">#&gt;  9:  paracetamol    ICD    17    254    271   582   599     9017       1.03      0.59      1.70      0.04    -0.77</span></span>
<span><span class="co">#&gt; 10: aripiprazole    ICD    40    281    321   559   599     8990       2.28      1.58      3.23      1.01     0.49</span></span>
<span><span class="co">#&gt; 11:         TGAs    ICD    47    318    365   552   599     8953       2.39      1.70      3.30      1.06     0.58</span></span>
<span><span class="co">#&gt; 12:  pramipexole    ICD    26     20     46   573   599     9251      20.98     11.18     39.88      3.00     2.35</span></span>
<span><span class="co">#&gt; 13:  paracetamol    ICD    14    957    971  1305  1319    43236       0.48      0.26      0.82     -0.99    -1.89</span></span>
<span><span class="co">#&gt; 14: aripiprazole    ICD   351   3424   3775   968  1319    40769       4.31      3.79      4.90      1.67     1.50</span></span>
<span><span class="co">#&gt; 15:         TGAs    ICD   374   3774   4148   945  1319    40419       4.23      3.73      4.80      1.63     1.46</span></span>
<span><span class="co">#&gt; 16:  pramipexole    ICD    14     67     81  1305  1319    44126       7.06      3.65     12.72      2.34     1.44</span></span>
<span><span class="co">#&gt; 17:  paracetamol    ICD    41   1598   1639  4245  4286   111477       0.67      0.48      0.91     -0.55    -1.07</span></span>
<span><span class="co">#&gt; 18: aripiprazole    ICD  1566  10649  12215  2720  4286   102426       5.53      5.18      5.91      1.81     1.72</span></span>
<span><span class="co">#&gt; 19:         TGAs    ICD  1645  12356  14001  2641  4286   100719       5.07      4.75      5.41      1.68     1.60</span></span>
<span><span class="co">#&gt; 20:  pramipexole    ICD    35    117    152  4251  4286   112958       7.94      5.27     11.70      2.55     1.98</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal  nested</span></span>
<span><span class="co">#&gt;        &lt;num&gt;                     &lt;char&gt;                    &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:    -0.48     0.67 (0.63-0.72) [962] -0.56 (-0.66--0.48) [962]      FALSE     no SDR    no SDR     raw</span></span>
<span><span class="co">#&gt;  2:     3.99  17.77 (17.25-18.3) [5208]   3.95 (3.91-3.99) [5208]       TRUE   weak SDR       SDR     raw</span></span>
<span><span class="co">#&gt;  3:     3.87 16.41 (15.96-16.89) [5666]   3.84 (3.79-3.87) [5666]       TRUE   weak SDR       SDR     raw</span></span>
<span><span class="co">#&gt;  4:     5.73 68.26 (65.14-71.25) [2376]   5.68 (5.62-5.73) [2376]       TRUE   weak SDR       SDR     raw</span></span>
<span><span class="co">#&gt;  5:     0.43       0.9 (0.52-1.46) [17]   -0.14 (-0.96-0.43) [17]      FALSE     no SDR    no SDR indi_pt</span></span>
<span><span class="co">#&gt;  6:     1.92    6.55 (6.06-7.08) [1310]   1.85 (1.76-1.92) [1310]       TRUE   weak SDR       SDR indi_pt</span></span>
<span><span class="co">#&gt;  7:     1.77    5.92 (5.48-6.39) [1371]   1.71 (1.62-1.77) [1371]       TRUE   weak SDR       SDR indi_pt</span></span>
<span><span class="co">#&gt;  8:     2.35       3.59 (1.37-7.99) [7]        1.5 (0.2-2.35) [7]       TRUE   weak SDR       SDR indi_pt</span></span>
<span><span class="co">#&gt;  9:     0.61       1.03 (0.59-1.7) [17]    0.04 (-0.77-0.61) [17]      FALSE     no SDR    no SDR reac_pt</span></span>
<span><span class="co">#&gt; 10:     1.39      2.28 (1.58-3.23) [40]     1.01 (0.49-1.39) [40]       TRUE   weak SDR       SDR reac_pt</span></span>
<span><span class="co">#&gt; 11:     1.41        2.39 (1.7-3.3) [47]     1.06 (0.58-1.41) [47]       TRUE   weak SDR       SDR reac_pt</span></span>
<span><span class="co">#&gt; 12:     3.47   20.98 (11.18-39.88) [26]        3 (2.35-3.47) [26]       TRUE   weak SDR       SDR reac_pt</span></span>
<span><span class="co">#&gt; 13:    -0.37      0.48 (0.26-0.82) [14]  -0.99 (-1.89--0.37) [14]      FALSE     no SDR    no SDR    drug</span></span>
<span><span class="co">#&gt; 14:     1.80      4.31 (3.79-4.9) [351]      1.67 (1.5-1.8) [351]       TRUE   weak SDR       SDR    drug</span></span>
<span><span class="co">#&gt; 15:     1.75      4.23 (3.73-4.8) [374]    1.63 (1.46-1.75) [374]       TRUE   weak SDR       SDR    drug</span></span>
<span><span class="co">#&gt; 16:     2.96     7.06 (3.65-12.72) [14]     2.34 (1.44-2.96) [14]       TRUE   weak SDR       SDR    drug</span></span>
<span><span class="co">#&gt; 17:    -0.17      0.67 (0.48-0.91) [41]  -0.55 (-1.07--0.17) [41]      FALSE     no SDR    no SDR   total</span></span>
<span><span class="co">#&gt; 18:     1.87    5.53 (5.18-5.91) [1566]   1.81 (1.72-1.87) [1566]       TRUE   weak SDR       SDR   total</span></span>
<span><span class="co">#&gt; 19:     1.74    5.07 (4.75-5.41) [1645]    1.68 (1.6-1.74) [1645]       TRUE   weak SDR       SDR   total</span></span>
<span><span class="co">#&gt; 20:     2.95      7.94 (5.27-11.7) [35]     2.55 (1.98-2.95) [35]       TRUE   weak SDR       SDR   total</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal  nested</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span>, nested <span class="op">=</span> <span class="st">"nested"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/retrieve_bipolar-1.png" alt="plot of chunk retrieve_bipolar"><div class="figcaption">plot of chunk retrieve_bipolar</div>
</div>
<p>In this forest plot we see that in general, restricting to the
confounder bipolar disorder, we see a smaller IC. Only paracetamol does
not show a difference, as bipolar disorder configures more as a
competitive exposure rather than a confounder (i.e., to be a confounder,
a factor has to cause both the drug and the event, but bipolar disorder
does not increase the chance of being prescribed paracetamol). We also
see that the confidence interval is smaller when we manage to retrieve
bigger background reference groups, and therefore using the information
included in both Indi, Drug, and Reac is suggested.</p>
<p>We can also consider that bipolar disorder may have been reported
using many other terms. How can we use the MedDRA HLGT “manic and
bipolar mood disorders and disturbances” to make even bigger the
reference group, still addressing the bias?</p>
<p>Note that this chunk of script works only if you have a MedDRA
subscription and you have followed <a href="#id_0" class="uri">https://github.com/fusarolimichele/DiAna</a> instructions to
make your own DiAna-compatible MedDRA.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reference groups --------------------------------------------------------------------</span></span>
<span><span class="co"># ....</span></span>
<span><span class="fu"><a href="../reference/import_MedDRA.html">import_MedDRA</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           def                                            soc                                                  hlgt</span></span>
<span><span class="co">#&gt;        &lt;char&gt;                                         &lt;char&gt;                                                &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1:   cong     congenital, familial and genetic disorders        metabolic and nutritional disorders congenital</span></span>
<span><span class="co">#&gt;     2:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     3:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     4:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;     5:    inv                                 investigations          endocrine investigations (incl sex hormones)</span></span>
<span><span class="co">#&gt;    ---                                                                                                            </span></span>
<span><span class="co">#&gt; 25408:  inj&amp;p injury, poisoning and procedural complications     procedural related injuries and complications nec</span></span>
<span><span class="co">#&gt; 25409:   preg pregnancy, puerperium and perinatal conditions pregnancy, labour, delivery and postpartum conditions</span></span>
<span><span class="co">#&gt; 25410:   surg                surgical and medical procedures   obstetric and gynaecological therapeutic procedures</span></span>
<span><span class="co">#&gt; 25411:   surg                surgical and medical procedures             male genital tract therapeutic procedures</span></span>
<span><span class="co">#&gt; 25412:  blood           blood and lymphatic system disorders                            white blood cell disorders</span></span>
<span><span class="co">#&gt;                                                  hlt                               pt</span></span>
<span><span class="co">#&gt;                                               &lt;char&gt;                           &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1:            inborn errors of steroid synthesis   11-beta-hydroxylase deficiency</span></span>
<span><span class="co">#&gt;     2:                 reproductive hormone analyses            17 ketosteroids urine</span></span>
<span><span class="co">#&gt;     3:                 reproductive hormone analyses  17 ketosteroids urine decreased</span></span>
<span><span class="co">#&gt;     4:                 reproductive hormone analyses  17 ketosteroids urine increased</span></span>
<span><span class="co">#&gt;     5:                 reproductive hormone analyses     17 ketosteroids urine normal</span></span>
<span><span class="co">#&gt;    ---                                                                               </span></span>
<span><span class="co">#&gt; 25408:    non-site specific procedural complications     incision site skin puckering</span></span>
<span><span class="co">#&gt; 25409:         normal pregnancy, labour and delivery spontaneous rupture of membranes</span></span>
<span><span class="co">#&gt; 25410:                 cervix therapeutic procedures           cervix stent placement</span></span>
<span><span class="co">#&gt; 25411: male genital tract therapeutic procedures nec           sperm cryopreservation</span></span>
<span><span class="co">#&gt; 25412:                        eosinophilic disorders      paraneoplastic eosinophilia</span></span>
<span><span class="va">bipolar_disorder_total_hlgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span></span>
<span>    <span class="va">Indi</span><span class="op">[</span><span class="va">indi_pt</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">MedDRA</span><span class="op">[</span><span class="va">hlgt</span> <span class="op">==</span> <span class="st">"manic and bipolar mood disorders and disturbances"</span><span class="op">]</span><span class="op">$</span><span class="va">pt</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span>,</span>
<span>    <span class="va">Reac</span><span class="op">[</span><span class="va">pt</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">MedDRA</span><span class="op">[</span><span class="va">hlgt</span> <span class="op">==</span> <span class="st">"manic and bipolar mood disorders and disturbances"</span><span class="op">]</span><span class="op">$</span><span class="va">pt</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="va">bipolar_disorder_drug</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span></span>
<span><span class="va">restrictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"raw"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span>,</span>
<span>  <span class="st">"total_pt"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_total_pt</span><span class="op">)</span>,</span>
<span>  <span class="st">"total_hlgt"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_total_hlgt</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">restrictions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">restrictions</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span>  <span class="va">t_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">t_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>    drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>    reac_selected <span class="op">=</span> <span class="va">reac_selected</span>,</span>
<span>    temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    restriction <span class="op">=</span> <span class="va">t_pids</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="va">nested</span> <span class="op">:=</span> <span class="va">t_name</span><span class="op">]</span></span>
<span>  <span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, <span class="va">df</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;           &lt;char&gt; &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol    ICD   962 341983 342945 71334 72296 17183644       0.67      0.63      0.72     -0.56    -0.66</span></span>
<span><span class="co">#&gt;  2: aripiprazole    ICD  5208  76217  81425 67088 72296 17449410      17.77     17.25     18.30      3.95     3.91</span></span>
<span><span class="co">#&gt;  3:         TGAs    ICD  5666  90313  95979 66630 72296 17435314      16.41     15.96     16.89      3.84     3.79</span></span>
<span><span class="co">#&gt;  4:  pramipexole    ICD  2376   8721  11097 69920 72296 17516906      68.26     65.14     71.25      5.68     5.62</span></span>
<span><span class="co">#&gt;  5:  paracetamol    ICD    41   1598   1639  4245  4286   111477       0.67      0.48      0.91     -0.55    -1.07</span></span>
<span><span class="co">#&gt;  6: aripiprazole    ICD  1566  10649  12215  2720  4286   102426       5.53      5.18      5.91      1.81     1.72</span></span>
<span><span class="co">#&gt;  7:         TGAs    ICD  1645  12356  14001  2641  4286   100719       5.07      4.75      5.41      1.68     1.60</span></span>
<span><span class="co">#&gt;  8:  pramipexole    ICD    35    117    152  4251  4286   112958       7.94      5.27     11.70      2.55     1.98</span></span>
<span><span class="co">#&gt;  9:  paracetamol    ICD    64   1791   1855  6243  6307   135909       0.77      0.59      0.99     -0.35    -0.76</span></span>
<span><span class="co">#&gt; 10: aripiprazole    ICD  1776  13032  14808  4531  6307   124668       3.74      3.53      3.97      1.45     1.37</span></span>
<span><span class="co">#&gt; 11:         TGAs    ICD  1890  15505  17395  4417  6307   122195       3.37      3.18      3.56      1.31     1.23</span></span>
<span><span class="co">#&gt; 12:  pramipexole    ICD   104    196    300  6203  6307   137504      11.76      9.16     15.01      2.93     2.61</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal     nested</span></span>
<span><span class="co">#&gt;        &lt;num&gt;                     &lt;char&gt;                    &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:    -0.48     0.67 (0.63-0.72) [962] -0.56 (-0.66--0.48) [962]      FALSE     no SDR    no SDR        raw</span></span>
<span><span class="co">#&gt;  2:     3.99  17.77 (17.25-18.3) [5208]   3.95 (3.91-3.99) [5208]       TRUE   weak SDR       SDR        raw</span></span>
<span><span class="co">#&gt;  3:     3.87 16.41 (15.96-16.89) [5666]   3.84 (3.79-3.87) [5666]       TRUE   weak SDR       SDR        raw</span></span>
<span><span class="co">#&gt;  4:     5.73 68.26 (65.14-71.25) [2376]   5.68 (5.62-5.73) [2376]       TRUE   weak SDR       SDR        raw</span></span>
<span><span class="co">#&gt;  5:    -0.17      0.67 (0.48-0.91) [41]  -0.55 (-1.07--0.17) [41]      FALSE     no SDR    no SDR   total_pt</span></span>
<span><span class="co">#&gt;  6:     1.87    5.53 (5.18-5.91) [1566]   1.81 (1.72-1.87) [1566]       TRUE   weak SDR       SDR   total_pt</span></span>
<span><span class="co">#&gt;  7:     1.74    5.07 (4.75-5.41) [1645]    1.68 (1.6-1.74) [1645]       TRUE   weak SDR       SDR   total_pt</span></span>
<span><span class="co">#&gt;  8:     2.95      7.94 (5.27-11.7) [35]     2.55 (1.98-2.95) [35]       TRUE   weak SDR       SDR   total_pt</span></span>
<span><span class="co">#&gt;  9:    -0.05      0.77 (0.59-0.99) [64]  -0.35 (-0.76--0.05) [64]      FALSE     no SDR    no SDR total_hlgt</span></span>
<span><span class="co">#&gt; 10:     1.50    3.74 (3.53-3.97) [1776]    1.45 (1.37-1.5) [1776]       TRUE   weak SDR       SDR total_hlgt</span></span>
<span><span class="co">#&gt; 11:     1.36    3.37 (3.18-3.56) [1890]   1.31 (1.23-1.36) [1890]       TRUE   weak SDR       SDR total_hlgt</span></span>
<span><span class="co">#&gt; 12:     3.17   11.76 (9.16-15.01) [104]    2.93 (2.61-3.17) [104]       TRUE   weak SDR       SDR total_hlgt</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span>, nested <span class="op">=</span> <span class="st">"nested"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/retrieve_with_MedDRA-1.png" alt="plot of chunk retrieve_with_MedDRA"><div class="figcaption">plot of chunk retrieve_with_MedDRA</div>
</div>
</div>
<div class="section level4">
<h4 id="addressing-notoriety-bias">Addressing notoriety bias<a class="anchor" aria-label="anchor" href="#addressing-notoriety-bias"></a>
</h4>
<p>The FDA warning in 2016-03-05 concerning aripiprazole-induced
impulsivity may have inflated the reporting distorting the results
(i.e., notoriety bias). To address this bias we can restrict only
reports submitted before the date of the warning, and repeat the
disproportionality analysis. We compare this result with the raw
analysis, the restriction to bipolar disorder, the restriction to
bipolar disorder pre-warning, and finally this last complete restriction
with also deduplication. All these analyses are performed considering
only suspected drugs.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reference groups ---------------------------------------------------------------------</span></span>
<span><span class="va">warning_date</span> <span class="op">&lt;-</span> <span class="fl">20160305</span></span>
<span><span class="va">pre_warning</span> <span class="op">&lt;-</span> <span class="va">Demo</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">init_fda_dt</span><span class="op">)</span>, <span class="va">fda_dt</span> <span class="op">&lt;</span> <span class="va">warning_date</span>, <span class="va">init_fda_dt</span> <span class="op">&lt;</span> <span class="va">warning_date</span><span class="op">)</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span></span>
<span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span></span>
<span><span class="va">restrictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"raw"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span>,</span>
<span>  <span class="st">"indication_bias"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">bipolar_disorder_total_pt</span><span class="op">)</span>,</span>
<span>  <span class="st">"notoriety_bias"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">pre_warning</span><span class="op">)</span>,</span>
<span>  <span class="st">"both_biases"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>    <span class="va">bipolar_disorder_total_pt</span>,</span>
<span>    <span class="va">pre_warning</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"both_biases_dedup"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>      <span class="va">bipolar_disorder_total_pt</span>, <span class="va">pre_warning</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">Demo</span><span class="op">[</span><span class="va">RB_duplicates</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">restrictions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">restrictions</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span>  <span class="va">t_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">t_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_analysis.html">disproportionality_analysis</a></span><span class="op">(</span></span>
<span>    drug_selected <span class="op">=</span> <span class="va">drug_selected</span>,</span>
<span>    reac_selected <span class="op">=</span> <span class="va">reac_selected</span>,</span>
<span>    temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    restriction <span class="op">=</span> <span class="va">t_pids</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="va">nested</span> <span class="op">:=</span> <span class="va">t_name</span><span class="op">]</span></span>
<span>  <span class="va">disproportionality_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, <span class="va">df</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">disproportionality_df</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;           &lt;char&gt; &lt;char&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;    &lt;num&gt;      &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  paracetamol    ICD   962 341983 342945 71334 72296 17183644       0.67      0.63      0.72     -0.56    -0.66</span></span>
<span><span class="co">#&gt;  2: aripiprazole    ICD  5208  76217  81425 67088 72296 17449410      17.77     17.25     18.30      3.95     3.91</span></span>
<span><span class="co">#&gt;  3:         TGAs    ICD  5666  90313  95979 66630 72296 17435314      16.41     15.96     16.89      3.84     3.79</span></span>
<span><span class="co">#&gt;  4:  pramipexole    ICD  2376   8721  11097 69920 72296 17516906      68.26     65.14     71.25      5.68     5.62</span></span>
<span><span class="co">#&gt;  5:  paracetamol    ICD    41   1598   1639  4245  4286   111477       0.67      0.48      0.91     -0.55    -1.07</span></span>
<span><span class="co">#&gt;  6: aripiprazole    ICD  1566  10649  12215  2720  4286   102426       5.53      5.18      5.91      1.81     1.72</span></span>
<span><span class="co">#&gt;  7:         TGAs    ICD  1645  12356  14001  2641  4286   100719       5.07      4.75      5.41      1.68     1.60</span></span>
<span><span class="co">#&gt;  8:  pramipexole    ICD    35    117    152  4251  4286   112958       7.94      5.27     11.70      2.55     1.98</span></span>
<span><span class="co">#&gt;  9:  paracetamol    ICD   415  79782  80197 37167 37582  6296895       0.88      0.79      0.97     -0.18    -0.35</span></span>
<span><span class="co">#&gt; 10: aripiprazole    ICD  1062  31287  32349 36520 37582  6345390       5.89      5.53      6.27      2.48     2.38</span></span>
<span><span class="co">#&gt; 11:         TGAs    ICD  1081  31812  32893 36501 37582  6344865       5.90      5.55      6.28      2.48     2.38</span></span>
<span><span class="co">#&gt; 12:  pramipexole    ICD  1846   4831   6677 35736 37582  6371846      68.14     64.42     72.04      5.54     5.46</span></span>
<span><span class="co">#&gt; 13:  paracetamol    ICD    17    573    590  1914  1931    60406       0.93      0.54      1.51     -0.09    -0.91</span></span>
<span><span class="co">#&gt; 14: aripiprazole    ICD   198   4771   4969  1733  1931    56208       1.34      1.15      1.56      0.37     0.14</span></span>
<span><span class="co">#&gt; 15:         TGAs    ICD   201   4809   5010  1730  1931    56170       1.35      1.16      1.57      0.38     0.15</span></span>
<span><span class="co">#&gt; 16:  pramipexole    ICD    25     63     88  1906  1931    60916      12.68      7.62     20.50      2.99     2.32</span></span>
<span><span class="co">#&gt; 17:  paracetamol    ICD    17    547    564  1889  1906    57300       0.94      0.54      1.52     -0.08    -0.90</span></span>
<span><span class="co">#&gt; 18: aripiprazole    ICD   188   4194   4382  1718  1906    53653       1.39      1.19      1.63      0.42     0.18</span></span>
<span><span class="co">#&gt; 19:         TGAs    ICD   191   4231   4422  1715  1906    53616       1.41      1.20      1.64      0.43     0.19</span></span>
<span><span class="co">#&gt; 20:  pramipexole    ICD    25     63     88  1881  1906    57784      12.19      7.32     19.69      2.94     2.27</span></span>
<span><span class="co">#&gt;        substance  event   D_E   D_nE      D  nD_E     E    nD_nE ROR_median ROR_lower ROR_upper IC_median IC_lower</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal            nested</span></span>
<span><span class="co">#&gt;        &lt;num&gt;                     &lt;char&gt;                    &lt;char&gt;     &lt;lgcl&gt;      &lt;ord&gt;     &lt;ord&gt;            &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:    -0.48     0.67 (0.63-0.72) [962] -0.56 (-0.66--0.48) [962]      FALSE     no SDR    no SDR               raw</span></span>
<span><span class="co">#&gt;  2:     3.99  17.77 (17.25-18.3) [5208]   3.95 (3.91-3.99) [5208]       TRUE   weak SDR       SDR               raw</span></span>
<span><span class="co">#&gt;  3:     3.87 16.41 (15.96-16.89) [5666]   3.84 (3.79-3.87) [5666]       TRUE   weak SDR       SDR               raw</span></span>
<span><span class="co">#&gt;  4:     5.73 68.26 (65.14-71.25) [2376]   5.68 (5.62-5.73) [2376]       TRUE   weak SDR       SDR               raw</span></span>
<span><span class="co">#&gt;  5:    -0.17      0.67 (0.48-0.91) [41]  -0.55 (-1.07--0.17) [41]      FALSE     no SDR    no SDR   indication_bias</span></span>
<span><span class="co">#&gt;  6:     1.87    5.53 (5.18-5.91) [1566]   1.81 (1.72-1.87) [1566]       TRUE   weak SDR       SDR   indication_bias</span></span>
<span><span class="co">#&gt;  7:     1.74    5.07 (4.75-5.41) [1645]    1.68 (1.6-1.74) [1645]       TRUE   weak SDR       SDR   indication_bias</span></span>
<span><span class="co">#&gt;  8:     2.95      7.94 (5.27-11.7) [35]     2.55 (1.98-2.95) [35]       TRUE   weak SDR       SDR   indication_bias</span></span>
<span><span class="co">#&gt;  9:    -0.07     0.88 (0.79-0.97) [415] -0.18 (-0.35--0.07) [415]      FALSE     no SDR    no SDR    notoriety_bias</span></span>
<span><span class="co">#&gt; 10:     2.55    5.89 (5.53-6.27) [1062]   2.48 (2.38-2.55) [1062]       TRUE   weak SDR       SDR    notoriety_bias</span></span>
<span><span class="co">#&gt; 11:     2.55     5.9 (5.55-6.28) [1081]   2.48 (2.38-2.55) [1081]       TRUE   weak SDR       SDR    notoriety_bias</span></span>
<span><span class="co">#&gt; 12:     5.59 68.14 (64.42-72.04) [1846]   5.54 (5.46-5.59) [1846]       TRUE   weak SDR       SDR    notoriety_bias</span></span>
<span><span class="co">#&gt; 13:     0.47      0.93 (0.54-1.51) [17]   -0.09 (-0.91-0.47) [17]      FALSE     no SDR    no SDR       both_biases</span></span>
<span><span class="co">#&gt; 14:     0.54     1.34 (1.15-1.56) [198]    0.37 (0.14-0.54) [198]       TRUE   weak SDR       SDR       both_biases</span></span>
<span><span class="co">#&gt; 15:     0.55     1.35 (1.16-1.57) [201]    0.38 (0.15-0.55) [201]       TRUE   weak SDR       SDR       both_biases</span></span>
<span><span class="co">#&gt; 16:     3.46     12.68 (7.62-20.5) [25]     2.99 (2.32-3.46) [25]       TRUE   weak SDR       SDR       both_biases</span></span>
<span><span class="co">#&gt; 17:     0.48      0.94 (0.54-1.52) [17]    -0.08 (-0.9-0.48) [17]      FALSE     no SDR    no SDR both_biases_dedup</span></span>
<span><span class="co">#&gt; 18:     0.60     1.39 (1.19-1.63) [188]     0.42 (0.18-0.6) [188]       TRUE   weak SDR       SDR both_biases_dedup</span></span>
<span><span class="co">#&gt; 19:     0.60      1.41 (1.2-1.64) [191]     0.43 (0.19-0.6) [191]       TRUE   weak SDR       SDR both_biases_dedup</span></span>
<span><span class="co">#&gt; 20:     3.41    12.19 (7.32-19.69) [25]     2.94 (2.27-3.41) [25]       TRUE   weak SDR       SDR both_biases_dedup</span></span>
<span><span class="co">#&gt;     IC_upper                  label_ROR                  label_IC Bonferroni ROR_signal IC_signal            nested</span></span>
<span><span class="fu"><a href="../reference/render_forest.html">render_forest</a></span><span class="op">(</span><span class="va">disproportionality_df</span>, row <span class="op">=</span> <span class="st">"event"</span>, facet_v <span class="op">=</span> <span class="st">"substance"</span>, nested <span class="op">=</span> <span class="st">"nested"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/notoriety_bias-1.png" alt="plot of chunk notoriety_bias"><div class="figcaption">plot of chunk notoriety_bias</div>
</div>
<p>Here you see in green the results of the analysis restricting to the
pre-warning. You can see that this analysis does not affect bipolar
disorder nor headache, but it affects all the impulse control disorders
apart gambling. Plausibly the FDA warning was based mainly on suspect
aripiprazole-induced gambling disorder.</p>
<p>Therefore, you can see that even before the warning and taking into
account all the considered biases, the FDA had enough information to
publish the warning.</p>
</div>
<div class="section level4">
<h4 id="disproportionality-trend">Disproportionality trend<a class="anchor" aria-label="anchor" href="#disproportionality-trend"></a>
</h4>
<p>Can we check when exactly a signal appeared in the FAERS? For example
in the case of the disproportionality restricted to bipolar disorder and
suspected drugs only?</p>
<p>For this inquiry, DiAna proposes a specific function:
disproportionality_trend, which allow to adopt a granularity of a month,
a quarter, or a year.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Import data --------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/import.html">import</a></span><span class="op">(</span><span class="st">"DEMO_SUPP"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           primaryid rpsr_cod   caseid caseversion i_f_cod auth_num  e_sub lit_ref  rept_dt to_mfr         mfr_sndr</span></span>
<span><span class="co">#&gt;               &lt;num&gt;   &lt;fctr&gt;    &lt;int&gt;      &lt;fctr&gt;  &lt;fctr&gt;   &lt;char&gt; &lt;fctr&gt;  &lt;char&gt;    &lt;int&gt; &lt;char&gt;           &lt;char&gt;</span></span>
<span><span class="co">#&gt;        1:  45217461       HP  4521746           1       I     &lt;NA&gt;      N    &lt;NA&gt;       NA   &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        2:  57910401     &lt;NA&gt;  5791040           1       I     &lt;NA&gt;      N    &lt;NA&gt;       NA   &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        3:  56962401     &lt;NA&gt;  5696240           1       I     &lt;NA&gt;      N    &lt;NA&gt;       NA   &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        4:  54662121      FGN  5466212           1       I     &lt;NA&gt;      N    &lt;NA&gt; 19961015   &lt;NA&gt; ELI LILLY AND CO</span></span>
<span><span class="co">#&gt;        5:  54662121       HP  5466212           1       I     &lt;NA&gt;      N    &lt;NA&gt; 19961015   &lt;NA&gt; ELI LILLY AND CO</span></span>
<span><span class="co">#&gt;       ---                                                                                                         </span></span>
<span><span class="co">#&gt; 18283734: 236937711      CSM 23693771           1       I   697702      N    &lt;NA&gt; 20240331      N          FDA-CTU</span></span>
<span><span class="co">#&gt; 18283735: 236937721      CSM 23693772           1       I   697662      N    &lt;NA&gt; 20240331      N          FDA-CTU</span></span>
<span><span class="co">#&gt; 18283736: 236937741      CSM 23693774           1       I   697678      N    &lt;NA&gt; 20240331   &lt;NA&gt;          FDA-CTU</span></span>
<span><span class="co">#&gt; 18283737: 237079261      CSM 23707926           1       I   697660      N    &lt;NA&gt; 20240331      Y          FDA-CTU</span></span>
<span><span class="co">#&gt; 18283738: 237079291      CSM 23707929           1       I   697693      N    &lt;NA&gt; 20240331      Y          FDA-CTU</span></span>
<span><span class="co">#&gt;               mfr_num   mfr_dt quarter</span></span>
<span><span class="co">#&gt;                &lt;char&gt;    &lt;int&gt;  &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;        1:        &lt;NA&gt;       NA    20Q3</span></span>
<span><span class="co">#&gt;        2:        &lt;NA&gt;       NA    20Q3</span></span>
<span><span class="co">#&gt;        3:        &lt;NA&gt;       NA    20Q3</span></span>
<span><span class="co">#&gt;        4: ZA96101984A 19961010    20Q3</span></span>
<span><span class="co">#&gt;        5: ZA96101984A 19961010    20Q3</span></span>
<span><span class="co">#&gt;       ---                             </span></span>
<span><span class="co">#&gt; 18283734:        &lt;NA&gt; 20240331    24Q1</span></span>
<span><span class="co">#&gt; 18283735:        &lt;NA&gt; 20240331    24Q1</span></span>
<span><span class="co">#&gt; 18283736:        &lt;NA&gt; 20240331    24Q1</span></span>
<span><span class="co">#&gt; 18283737:        &lt;NA&gt; 20240331    24Q1</span></span>
<span><span class="co">#&gt; 18283738:        &lt;NA&gt; 20240331    24Q1</span></span>
<span><span class="co">## Disproportionality analysis ----------------------------------------------------------</span></span>
<span><span class="va">disproportionality_trend_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disproportionality_trend.html">disproportionality_trend</a></span><span class="op">(</span></span>
<span>  drug_selected <span class="op">=</span> <span class="st">"brexpiprazole"</span>,</span>
<span>  reac_selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">reac_selected</span><span class="op">)</span>,</span>
<span>  temp_drug <span class="op">=</span> <span class="va">Drug</span><span class="op">[</span><span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  time_granularity <span class="op">=</span> <span class="st">"year"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_disproportionality_trend.html">plot_disproportionality_trend</a></span><span class="op">(</span>disproportionality_trend_results <span class="op">=</span> <span class="va">disproportionality_trend_df</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/disproportionality_trend-1.png" alt="plot of chunk disproportionality_trend"><div class="figcaption">plot of chunk disproportionality_trend</div>
</div>
</div>
<div class="section level4">
<h4 id="comparing-several-disproportionality-metrics">Comparing several disproportionality metrics<a class="anchor" aria-label="anchor" href="#comparing-several-disproportionality-metrics"></a>
</h4>
<p>The ROR and the IC, while extremely common in pharmacovigilance, are
not the only disproportionality metrics. To compare their results with
other disproportionality metrics you can use the
disproportionality_comparison function</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/disproportionality_comparison.html">disproportionality_comparison</a></span><span class="op">(</span></span>
<span>  drug_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Drug</span><span class="op">[</span><span class="va">substance</span> <span class="op">==</span> <span class="st">"aripiprazole"</span> <span class="op">&amp;</span> <span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  event_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Reac</span><span class="op">[</span><span class="va">pt</span> <span class="op">==</span> <span class="st">"impulsive behaviour"</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  drug_event_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">Drug</span><span class="op">[</span><span class="va">substance</span> <span class="op">==</span> <span class="st">"aripiprazole"</span> <span class="op">&amp;</span> <span class="va">role_cod</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PS"</span>, <span class="st">"SS"</span><span class="op">)</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span>, <span class="va">Reac</span><span class="op">[</span><span class="va">pt</span> <span class="op">==</span> <span class="st">"impulsive behaviour"</span><span class="op">]</span><span class="op">$</span><span class="va">primaryid</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Demo</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;       E       nE</span></span>
<span><span class="co">#&gt; D   379    81046</span></span>
<span><span class="co">#&gt; nD 2885 17514169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ROR = 28.39 (25.4-31.58)</span></span>
<span><span class="co">#&gt; PRR = 28.26 (25.4-31.45)</span></span>
<span><span class="co">#&gt; RRR = 25.1 (22.57-27.91)</span></span>
<span><span class="co">#&gt; IC = 4.6 (4.43-4.72)</span></span>
<span><span class="co">#&gt; IC_gamma = 4.48 (4.46-4.75)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michele Fusaroli, Valentina Giunchi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
